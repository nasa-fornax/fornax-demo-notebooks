<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Extract Multi-Wavelength Spectroscopy from Archival Data - The Fornax Initiative</title><meta property="og:title" content="Extract Multi-Wavelength Spectroscopy from Archival Data - The Fornax Initiative"/><meta name="generator" content="mystmd"/><meta name="description" content="Tutorial notebooks for example Fornax use cases"/><meta property="og:description" content="Tutorial notebooks for example Fornax use cases"/><meta name="keywords" content="astronomy"/><link rel="stylesheet" href="/fornax-demo-notebooks/build/_assets/app-PKKJHBHV.css"/><link rel="stylesheet" href="/fornax-demo-notebooks/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/fornax-demo-notebooks/favicon.ico"/><link rel="stylesheet" href="/fornax-demo-notebooks/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/fornax-demo-notebooks/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/fornax-demo-notebooks/build/fornax_logo-6b5402cd4200a10a0cbec9b3503e3ce5.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R758p:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="The Fornax Initiative" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/fornax-demo-notebooks/">The Fornax Initiative</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Time Domain" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fornax-demo-notebooks/readme">Time Domain</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Spectroscopy" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fornax-demo-notebooks/readme-1">Spectroscopy</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Multi-band forced photometry" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fornax-demo-notebooks/readme-2">Multi-band forced photometry</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16pop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16pop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Cross Matching" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fornax-demo-notebooks/readme-3">Cross Matching</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1epop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1epop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center mb-5 h-6 text-sm font-light"><div class="flex-none pr-2 smallcaps">Fornax Demo Notebooks</div><div class="flex-grow"></div><a href="https://github.com/nasa-fornax/fornax-demo-notebooks" title="GitHub Repository: nasa-fornax/fornax-demo-notebooks" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/nasa-fornax/fornax-demo-notebooks/edit/main/spectroscopy/spectra_collector.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8u8p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Extract Multi-Wavelength Spectroscopy from Archival Data</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78u8p:" data-state="closed">Fornax developers and scientists</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><h2 id="learning-goals" class="relative group"><span class="heading-text">Learning Goals</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-goals" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this tutorial, you will be able to:</p><p>• automatically load a catalog of sources</p><p>• search NASA and non-NASA resources for fully reduced spectra and load them using specutils</p><p>• store the spectra in a Pandas multiindex dataframe</p><p>• plot all the spectra of a given source</p><h2 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="motivation" class="relative group"><span class="heading-text">Motivation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#motivation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>A user has a source (or a sample of sources) for which they want to obtain spectra covering ranges
of wavelengths from the UV to the far-IR. The large amount of spectra available enables
multi-wavelength spectroscopic studies, which is crucial to understand the physics of stars,
galaxies, and AGN. However, gathering and analysing spectra is a difficult endeavor as the spectra
are distributed over different archives and in addition they have different formats which
complicates their handling. This notebook showcases a tool for the user to conveniently query the
spectral archives and collect the spectra for a set of objects in a format that can be read in
using common software such as the Python <code>specutils</code> package. For simplicity, we limit the tool to
query already reduced and calibrated spectra.
The notebook may focus on the COSMOS field for now, which has a large overlap of spectroscopic
surveys such as with SDSS, DESI, Keck, HST, JWST, Spitzer, and Herschel. In addition, the tool
enables the capability to search and ingest spectra from Euclid and SPHEREx in the feature. For
this to work, the <code>specutils</code> functions may have to be update or a wrapper has to be implemented.</p><h3 id="list-of-spectroscopic-archives-and-status" class="relative group"><span class="heading-text">List of Spectroscopic Archives and Status</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#list-of-spectroscopic-archives-and-status" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><table class=""><tbody><tr class=""><th class="">Archive</th><th class="">Spectra</th><th class="">Description</th><th class="">Access point</th><th class="">Status</th></tr><tr class=""><td class="">IRSA</td><td class="">Keck</td><td class="">About 10,000 spectra on the COSMOS field from <a target="_blank" rel="noreferrer" href="https://ui.adsabs.harvard.edu/abs/2018ApJ...858...77H/abstract" class="">Hasinger et al. (2018)</a></td><td class=""><a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-scan?projshort=COSMOS" class="">IRSA Archive</a></td><td class="">Implemented with <code>astroquery.ipac.irsa</code>. (Table gives URLs to spectrum FITS files.) Note: only implemented for absolute calibrated spectra.</td></tr><tr class=""><td class="">IRSA</td><td class="">Spitzer IRS</td><td class="">~17,000 merged low-resolution IRS spectra</td><td class=""><a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-dd?catalog=irs_enhv211" class="">IRS Enhanced Product</a></td><td class="">Implemented with <code>astroquery.ipac.irsa</code>. (Table gives URLs to spectrum IPAC tables.)</td></tr><tr class=""><td class="">IRSA</td><td class="">IRTF*</td><td class="">Large library of stellar spectra</td><td class=""></td><td class="">does <code>astroquery.ipac.irsa</code> work??</td></tr><tr class=""><td class="">ESA</td><td class="">Herschel*</td><td class="">Some spectra</td><td class="">astroquery.esa.hsa</td><td class="">implemented with <a target="_blank" rel="noreferrer" href="https://astroquery.readthedocs.io/en/latest/esa/hsa/hsa.html" class="">astroquery</a></td></tr><tr class=""><td class="">IRSA</td><td class="">Euclid</td><td class="">Spectra hosted at IRSA in FY25</td><td class=""></td><td class="">Using Q1 Spectra in the red grism (RGS) ingested in FY25, to be updated to DR1</td></tr><tr class=""><td class="">IRSA</td><td class="">SPHEREx</td><td class="">Spectra/cubes will be hosted at IRSA, first release in FY25 -&gt; preparation for ingestion</td><td class=""></td><td class="">Will use mock spectra with correct format for testing</td></tr><tr class=""><td class="">MAST</td><td class="">HST*</td><td class="">Slitless spectra would need reduction and extraction. There are some reduced slit spectra from COS in the Hubble Archive</td><td class=""><code>astroquery.mast</code></td><td class="">Implemented using <code>astroquery.mast</code></td></tr><tr class=""><td class="">MAST</td><td class="">JWST*</td><td class="">Reduced slit MSA and Slit spectra that can be queried</td><td class=""><code>astroquery.mast</code></td><td class="">Implemented using <code>astroquery.mast</code></td></tr><tr class=""><td class="">SDSS</td><td class="">SDSS optical</td><td class="">Optical spectra that are reduced</td><td class=""><a target="_blank" rel="noreferrer" href="https://skyserver.sdss.org/dr18/SearchTools" class="">Sky Server</a> or <code>astroquery.sdss</code> (preferred)</td><td class="">Implemented using <code>astroquery.sdss</code>.</td></tr><tr class=""><td class="">DESI</td><td class="">DESI*</td><td class="">Optical spectra</td><td class=""><a target="_blank" rel="noreferrer" href="https://data.desi.lbl.gov/public/" class="">DESI public data release</a></td><td class="">Implemented with <code>SPARCL</code> library.  Currently commented out because <code>SPARCL</code> library is incompatible with numpy &gt; 2 which we need for other modules</td></tr><tr class=""><td class="">BOSS</td><td class="">BOSS*</td><td class="">Optical spectra</td><td class=""><a target="_blank" rel="noreferrer" href="https://www.sdss4.org/surveys/boss/" class="">BOSS webpage (part of SDSS)</a></td><td class="">Implemented with <code>SPARCL</code> library together with DESI</td></tr><tr class=""><td class="">HEASARC</td><td class="">None</td><td class="">Could link to Chandra observations to check AGN occurrence.</td><td class=""><code>astroquery.heasarc</code></td><td class="">More thoughts on how to include scientifically.</td></tr></tbody></table><p>The ones with an asterisk (*) are the challenging ones.</p><h3 id="input" class="relative group"><span class="heading-text">Input</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#input" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>• Coordinates for a single source or a sample on the COSMOS field</p><h3 id="output" class="relative group"><span class="heading-text">Output</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#output" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>• A Pandas data frame including the spectra from different facilities</p><p>• A plot comparing the different spectra extracted for each source</p><h3 id="runtime" class="relative group"><span class="heading-text">Runtime</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#runtime" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>As of 2025 July, this notebook takes about 18 minutes to run to completion on Fornax using
a server with 16GB RAM/4 CPU’ and Environment: ‘Default Astrophysics’ (image).</p><h3 id="datasets-that-were-considered-but-didnt-end-up-being-used" class="relative group"><span class="heading-text">Datasets that were considered but didn’t end up being used</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#datasets-that-were-considered-but-didnt-end-up-being-used" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>IRTF:</p><ul><li><p><a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/Missions/irtf.html" class="">https://<wbr/>irsa<wbr/>.ipac<wbr/>.caltech<wbr/>.edu<wbr/>/Missions<wbr/>/irtf<wbr/>.html</a></p></li><li><p>The IRTF is a 3.2 meter telescope, optimized for infrared observations, and located at the summit
of Mauna Kea, Hawaiʻi.</p></li><li><p>large library of stellar spectra</p></li><li><p>Not included here because the data are not currently available in an easily accessible,
searchable format</p></li></ul><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This cell will install them if needed:</p><div id="Q5AnxSHrpx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment the next line to install dependencies if needed.
# %pip install -r requirements_spectra_collector.txt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="v5UI01dp_gMm8ROhcgeDu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LykUydrj7i" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import sys

import astropy.units as u
from astropy.coordinates import SkyCoord
from astropy.table import Table
from astropy.utils.data import conf

sys.path.append(&#x27;code_src/&#x27;)
from data_structures_spec import MultiIndexDFObject
#from desi_functions import DESIBOSS_get_spec
from herschel_functions import Herschel_get_spec
from keck_functions import KeckDEIMOS_get_spec
from mast_functions import HST_get_spec, JWST_get_spec
from plot_functions import create_figures
from sample_selection import clean_sample
from sdss_functions import SDSS_get_spec
from spitzer_functions import SpitzerIRS_get_spec
from euclid_functions import euclid_get_spec

# The Euclid spectrum files are large and the time it takes to read
# them can exceed astropy&#x27;s default timeout limit. Increase it.
conf.remote_timeout = 120</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="sSKFwXApglVbdehNjpL8_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-1-define-the-sample" class="relative group"><span class="heading-text">1. Define the sample</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-define-the-sample" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we will define the sample of galaxies. For now, we just enter some “random” coordinates to
test the code.</p><div id="GDbMrOyP1b" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coords = []
labels = []

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;09 54 49.40&quot;, &quot;+09 16 15.9&quot;), unit=(u.hourangle, u.deg)))
labels.append(&quot;NGC3049&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;12 45 17.44 &quot;, &quot;27 07 31.8&quot;), unit=(u.hourangle, u.deg)))
labels.append(&quot;NGC4670&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;14 01 19.92&quot;, &quot;−33 04 10.7&quot;), unit=(u.hourangle, u.deg)))
labels.append(&quot;Tol_89&quot;)

coords.append(SkyCoord(233.73856, 23.50321, unit=u.deg))
labels.append(&quot;Arp220&quot;)

coords.append(SkyCoord(150.091, 2.2745833, unit=u.deg))
labels.append(&quot;COSMOS1&quot;)

coords.append(SkyCoord(150.1024475, 2.2815559, unit=u.deg))
labels.append(&quot;COSMOS2&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;150.000&quot;, &quot;+2.00&quot;), unit=(u.deg, u.deg)))
labels.append(&quot;COSMOS3&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;+53.15508&quot;, &quot;-27.80178&quot;), unit=(u.deg, u.deg)))
labels.append(&quot;JADESGS-z7-01-QU&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;+53.15398&quot;, &quot;-27.80095&quot;), unit=(u.deg, u.deg)))
labels.append(&quot;TestJWST&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;268.48058743&quot;, &quot;64.78064676&quot;), unit=(u.deg, u.deg)))
labels.append(&quot;TestEuclid&quot;)

coords.append(SkyCoord(&quot;{} {}&quot;.format(&quot;+150.33622&quot;, &quot;+55.89878&quot;), unit=(u.deg, u.deg)))
labels.append(&quot;Twin Quasar&quot;)

sample_table = clean_sample(coords, labels, precision=2.0 * u.arcsecond, verbose=1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Fzom0sN7thhPDkCvomKWr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>after duplicates removal, sample size: 11
</span></code></pre></div></div></div><h3 id="id-1-2-write-out-your-sample-to-disk" class="relative group"><span class="heading-text">1.2 Write out your sample to disk</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-2-write-out-your-sample-to-disk" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>At this point you may wish to write out your sample to disk and reuse that in future work sessions,
instead of creating it from scratch again. Note that we first check if the <code>data</code> directory exists
and if not, we will create one.</p><p>For the format of the save file, we would suggest to choose from various formats that fully support
astropy objects(eg., SkyCoord).  One example that works is Enhanced Character-Separated Values or
<a target="_blank" rel="noreferrer" href="https://docs.astropy.org/en/stable/io/ascii/ecsv.html" class="">‘ecsv’</a></p><div id="qy153MYKt9" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">if not os.path.exists(&quot;./data&quot;):
    os.mkdir(&quot;./data&quot;)
sample_table.write(&#x27;data/input_sample.ecsv&#x27;, format=&#x27;ascii.ecsv&#x27;, overwrite=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-iSzk4VETh2jHUoN8nh8s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="id-1-3-load-the-sample-table-from-disk" class="relative group"><span class="heading-text">1.3 Load the sample table from disk</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-3-load-the-sample-table-from-disk" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Do only this step from this section when you have a previously generated sample table</p><div id="QgWDxOs77l" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">sample_table = Table.read(&#x27;data/input_sample.ecsv&#x27;, format=&#x27;ascii.ecsv&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Bf1PP6kCfGlVft9qS7-8m" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="id-1-4-initialize-data-structure-to-hold-the-spectra" class="relative group"><span class="heading-text">1.4 Initialize data structure to hold the spectra</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-4-initialize-data-structure-to-hold-the-spectra" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here, we initialize the MultiIndex data structure that will hold the spectra.</p><div id="PhlVsfmRbq" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df_spec = MultiIndexDFObject()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HZefwZYq54qCzsdiHjoNP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-2-find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs" class="relative group"><span class="heading-text">2. Find spectra for these targets in NASA and other ancillary catalogs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We search a curated list of NASA astrophysics archives.  Because each archive is different, and in
many cases each catalog is different, each function to access a catalog is necesarily specialized
to the location and format of that particular catalog.</p><h3 id="id-2-1-irsa-archive" class="relative group"><span class="heading-text">2.1 IRSA Archive</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-1-irsa-archive" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>This archive includes spectra taken by</p><p>• Keck</p><p>• Spitzer/IRS</p><p>• Euclid/NISP</p><div id="LFGI7XtECo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# Get Keck Spectra (COSMOS only)
df_spec_DEIMOS = KeckDEIMOS_get_spec(sample_table=sample_table, search_radius_arcsec=1)
df_spec.append(df_spec_DEIMOS)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dAQdzm03gqJSbvkQ06NMk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 1
no calibration is available
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
CPU times: user 315 ms, sys: 10.4 ms, total: 326 ms
Wall time: 21.1 s
</span></code></pre></div></div></div><div id="KlYOU2tSx2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# Get Spitzer IRS Spectra
df_spec_IRS = SpitzerIRS_get_spec(sample_table, search_radius_arcsec=1, COMBINESPEC=False)
df_spec.append(df_spec_IRS)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="M35ESxHj3V9eLJAgwVaUx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Processing source NGC3049
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source NGC4670
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source Tol_89
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source Arp220
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 8
More than 1 entry found - pick the closest
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source COSMOS1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source COSMOS2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source COSMOS3
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source JADESGS-z7-01-QU
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source TestJWST
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source TestEuclid
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
Processing source Twin Quasar
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of entries found: 0
CPU times: user 430 ms, sys: 10.8 ms, total: 441 ms
Wall time: 20.8 s
</span></code></pre></div></div></div><div id="Cn8g3HinWL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# Get Euclid Spectra
df_spec_Euclid = euclid_get_spec(sample_table=sample_table, search_radius_arcsec=1)
df_spec.append(df_spec_Euclid)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="d0RYoFo8PdNYvszzT41Cu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Processing source NGC3049
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for NGC3049.
Processing source NGC4670
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for NGC4670.
Processing source Tol_89
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for Tol_89.
Processing source Arp220
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for Arp220.
Processing source COSMOS1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for COSMOS1.
Processing source COSMOS2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for COSMOS2.
Processing source COSMOS3
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for COSMOS3.
Processing source JADESGS-z7-01-QU
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for JADESGS-z7-01-QU.
Processing source TestJWST
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for TestJWST.
Processing source TestEuclid
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Found Euclid object_id: 2684805874647806467
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source Twin Quasar
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>No match found in Euclid MER catalog for Twin Quasar.
CPU times: user 2.14 s, sys: 85 ms, total: 2.22 s
Wall time: 36.2 s
</span></code></pre></div></div></div><h3 id="id-2-2-mast-archive" class="relative group"><span class="heading-text">2.2 MAST Archive</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-2-mast-archive" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>This archive includes spectra taken by</p><p>• HST (including slit spectroscopy)</p><p>• JWST (including MSA and slit spectroscopy)</p><div id="IzcFtAr6wO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# Get Spectra for HST
df_spec_HST = HST_get_spec(
    sample_table,
    search_radius_arcsec=0.5,
    datadir=&quot;./data/&quot;,
    verbose=False,
    delete_downloaded_data=True
)
df_spec.append(df_spec_HST)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hkpQU7sOVQrtBhVtb3dj8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Processing source NGC3049
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 9
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 4
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source NGC4670
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 6
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source Tol_89
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 9
Number of files to download: 3
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source Arp220
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source Arp220 could not be found
Processing source COSMOS1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 4
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 0
Nothing to download for source COSMOS1.
Processing source COSMOS2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 3
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 0
Nothing to download for source COSMOS2.
Processing source COSMOS3
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 0
Nothing to download for source COSMOS3.
Processing source JADESGS-z7-01-QU
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 97
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 0
Nothing to download for source JADESGS-z7-01-QU.
Processing source TestJWST
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 93
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 0
Nothing to download for source TestJWST.
Processing source TestEuclid
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source TestEuclid could not be found
Processing source Twin Quasar
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 6
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files to download: 2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>CPU times: user 2.57 s, sys: 55.3 ms, total: 2.63 s
Wall time: 2min 45s
</span></code></pre></div></div></div><div id="B874AViZSM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# Get Spectra for JWST
df_jwst = JWST_get_spec(
    sample_table,
    search_radius_arcsec=0.5,
    verbose=False,
    max_spectra_per_source = 5
)
df_spec.append(df_jwst)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7T9eEaKZV2PLvdO0SLfXg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Searching Spectra in the cloud... 
INFO: Using the S3 STScI public dataset [astroquery.mast.cloud]
Processing source NGC3049
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source NGC3049 could not be found
Processing source NGC4670
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source NGC4670 could not be found
Processing source Tol_89
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source Tol_89 could not be found
Processing source Arp220
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source Arp220 could not be found
Processing source COSMOS1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source COSMOS1 could not be found
Processing source COSMOS2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files found: 12
Limiting to first 5 spectra for source COSMOS2.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>WARNING: NoResultsWarning: Unable to locate file jwst/public/jw02565/jw02565001001/jw02565001001_03101_00004_nrs2_x1d.fits. [astroquery.mast.cloud]
WARNING: NoResultsWarning: Unable to locate file jwst/public/jw02565/jw02565001001/jw02565001001_03101_00003_nrs2_x1d.fits. [astroquery.mast.cloud]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Skipping jw02565001001_03101_00004_nrs2_x1d.fits: not available in cloud.
Skipping jw02565001001_03101_00003_nrs2_x1d.fits: not available in cloud.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source COSMOS3
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source COSMOS3 could not be found
Processing source JADESGS-z7-01-QU
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 18
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files found: 612
Limiting to first 5 spectra for source JADESGS-z7-01-QU.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source TestJWST
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 6
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of files found: 630
Limiting to first 5 spectra for source TestJWST.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing source TestEuclid
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source TestEuclid could not be found
Processing source Twin Quasar
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Number of search results: 0
Source Twin Quasar could not be found
done
Grouping Spectra... 
Grouping object COSMOS2
Grouping object JADESGS-z7-01-QU
Grouping object TestJWST
done
CPU times: user 10.6 s, sys: 881 ms, total: 11.5 s
Wall time: 3min 2s
</span></code></pre></div></div></div><h3 id="id-2-3-esa-archive" class="relative group"><span class="heading-text">2.3 ESA Archive</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-3-esa-archive" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="rRvCUk5xo7" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Herschel PACS &amp; SPIRE from ESA TAP using astroquery
# This search is fully functional, but is commented out because it takes
# ~4 hours to run to completion
herschel_radius = 1.1
herschel_download_directory = &#x27;data/herschel&#x27;

# if not os.path.exists(herschel_download_directory):
#    os.makedirs(herschel_download_directory, exist_ok=True)
# df_spec_herschel =  Herschel_get_spec(sample_table, herschel_radius, herschel_download_directory, delete_downloaded_data=True)
# df_spec.append(df_spec_herschel)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LvGdliMgvKy9m32UdMfxR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="id-2-4-sdss-archive" class="relative group"><span class="heading-text">2.4 SDSS Archive</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-4-sdss-archive" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="Bcu5d2mZjz" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# Get SDSS Spectra
df_spec_SDSS = SDSS_get_spec(sample_table, search_radius_arcsec=5, data_release=17)
df_spec.append(df_spec_SDSS)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0YwA9wcX8_dG8F1Hwkhj0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Source Tol_89 could not be found
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Source COSMOS1 could not be found
Source COSMOS2 could not be found
Source COSMOS3 could not be found
Source JADESGS-z7-01-QU could not be found
Source TestJWST could not be found
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Source TestEuclid could not be found
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>CPU times: user 149 ms, sys: 16.2 ms, total: 166 ms
Wall time: 2.81 s
</span></code></pre></div></div></div><h3 id="id-2-5-desi-archive" class="relative group"><span class="heading-text">2.5 DESI Archive</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-5-desi-archive" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>This includes DESI spectra. Here, we use the <code>SPARCL</code> query. Note that this can also be used
for SDSS searches, however, according to the SPARCL webpage, only up to DR16 is included.
Therefore, we will not include SDSS DR16 here (this is treated in the SDSS search above).</p><p>The DESI search is currently commented out because <code>SPARCL</code> is not compatible with numpy &gt; 2 which we require for the other modules to run.</p><div id="KZnZr2vKzq" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#%%time
## Get DESI and BOSS spectra with SPARCL
#df_spec_DESIBOSS = DESIBOSS_get_spec(sample_table, search_radius_arcsec=5)
#df_spec.append(df_spec_DESIBOSS)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Gjk0GIv6ldBEmkf-Edf_F" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-3-make-plots-of-luminosity-as-a-function-of-time" class="relative group"><span class="heading-text">3. Make plots of luminosity as a function of time</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-make-plots-of-luminosity-as-a-function-of-time" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We show flux in mJy as a function of time for all available bands for each object.
<code>show_nbr_figures</code> controls how many plots are actually generated and returned to the screen.
If you choose to save the plots with <code>save_output</code>, they will be put in the output directory and
labelled by sample number.</p><div id="Lyj0aj9HC4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">### Plotting ####
create_figures(df_spec=df_spec,
               bin_factor=1,
               show_nbr_figures=10,
               save_output=False,
               )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lFLC0dFbAfBiuYdv7Sx-K" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fornax-demo-notebooks/build/d38ce462e66bf90a39dfd489574e22bb.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/dbff4ce61f40d0444294fd591084e8e8.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/68209f3d54df12fa9c48f2b27ebd1b60.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/60e1a126343e69571fc3179bb46ff5f7.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/116f880658646a698c7de2b52633fcfe.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/7ff530544305bdd7270f38ec4ea9fdfc.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/f94d78d26afbee56681b3414d51326c0.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/34a7f9b7d39994a07524fb4d85df5c70.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/><img src="/fornax-demo-notebooks/build/636d7942d8d9bd566a3ad7fd1410a061.png" alt="&lt;Figure size 900x600 with 1 Axes&gt;"/></div></div><h2 id="about-this-notebook" class="relative group"><span class="heading-text">About this notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#about-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p><strong>Authors:</strong> Andreas Faisst, Jessica Krick, Shoubaneh Hemmati, Troy Raen, Brigitta Sipőcz, David Shupe, and the Fornax team</p></li><li><p><strong>Contact:</strong> For help with this notebook, please open a topic in the <a target="_blank" rel="noreferrer" href="https://discourse.fornax.sciencecloud.nasa.gov/" class="">Fornax Community Forum</a> “Support” category.</p></li></ul><h3 id="acknowledgements" class="relative group"><span class="heading-text">Acknowledgements</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#acknowledgements" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><p>AI: This notebook was created with assistance from OpenAI’s ChatGPT o4-mini-high model.</p></li></ul><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fornax-demo-notebooks/readme-1"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">The Fornax Initiative</div>Spectroscopy</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fornax-demo-notebooks/readme-2"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">The Fornax Initiative</div>Multi-band forced photometry</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/fornax-demo-notebooks/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-N2N6M3QH.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/root-ZJZ4LRPY.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/_shared/chunk-KGDL62ZF.js"/><link rel="modulepreload" href="/fornax-demo-notebooks/build/routes/$-23AHH5XS.js"/><script>window.__remixContext = {"url":"/spectra-collector","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"favicon":"/fornax-demo-notebooks/build/fornax_favicon-1e9ff6cbaa8048bd683b1583f7afe082.ico","logo":"/fornax-demo-notebooks/build/fornax_logo-6b5402cd4200a10a0cbec9b3503e3ce5.png"},"nav":[],"actions":[],"projects":[{"subject":"Fornax Demo Notebooks","settings":{"output_matplotlib_strings":"remove"},"description":"Tutorial notebooks for example Fornax use cases","authors":[{"id":"Fornax developers and scientists","name":"Fornax developers and scientists"}],"github":"https://github.com/nasa-fornax/fornax-demo-notebooks","keywords":["astronomy"],"references":{"fornax-docs":{"url":"https://docs.fornax.sciencecloud.nasa.gov"}},"toc":[{"file":"index.md"},{"children":[{"file":"light_curves/light_curve_collector.md"},{"file":"light_curves/scale_up.md"},{"file":"light_curves/light_curve_classifier.md"},{"file":"light_curves/ML_AGNzoo.md"}],"file":"light_curves/README.md","title":"Light Curves"},{"children":[{"file":"spectroscopy/spectra_collector.md"}],"file":"spectroscopy/README.md","title":"Spectroscopy"},{"children":[{"file":"forced_photometry/multiband_photometry.md"}],"file":"forced_photometry/README.md","title":"Forced Photometry"},{"children":[{"file":"crossmatch/ztf_ps1_crossmatch.md"}],"file":"crossmatch/README.md","title":"Crossmatch"}],"exports":[],"bibliography":[],"title":"The Fornax Initiative","index":"index","pages":[{"slug":"readme","title":"Time Domain","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"light-curve-collector","title":"Make Multi-Wavelength Light Curves Using Archival Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"scale-up","title":"Make Multi-Wavelength Light Curves for Large Samples","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"light-curve-classifier","title":"Light Curve Classifier","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ml-agnzoo","title":"AGN Zoo: Comparison of AGN selected with different metrics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-1","title":"Spectroscopy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"spectra-collector","title":"Extract Multi-Wavelength Spectroscopy from Archival Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-2","title":"Multi-band forced photometry","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"multiband-photometry","title":"Automated Multiband Forced Photometry on Large Datasets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-3","title":"Cross Matching","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ztf-ps1-crossmatch","title":"Cross-Match ZTF and Pan-STARRS using LSDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/fornax-demo-notebooks"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"favicon":"/fornax-demo-notebooks/build/fornax_favicon-1e9ff6cbaa8048bd683b1583f7afe082.ico","logo":"/fornax-demo-notebooks/build/fornax_logo-6b5402cd4200a10a0cbec9b3503e3ce5.png"},"nav":[],"actions":[],"projects":[{"subject":"Fornax Demo Notebooks","settings":{"output_matplotlib_strings":"remove"},"description":"Tutorial notebooks for example Fornax use cases","authors":[{"id":"Fornax developers and scientists","name":"Fornax developers and scientists"}],"github":"https://github.com/nasa-fornax/fornax-demo-notebooks","keywords":["astronomy"],"references":{"fornax-docs":{"url":"https://docs.fornax.sciencecloud.nasa.gov"}},"toc":[{"file":"index.md"},{"children":[{"file":"light_curves/light_curve_collector.md"},{"file":"light_curves/scale_up.md"},{"file":"light_curves/light_curve_classifier.md"},{"file":"light_curves/ML_AGNzoo.md"}],"file":"light_curves/README.md","title":"Light Curves"},{"children":[{"file":"spectroscopy/spectra_collector.md"}],"file":"spectroscopy/README.md","title":"Spectroscopy"},{"children":[{"file":"forced_photometry/multiband_photometry.md"}],"file":"forced_photometry/README.md","title":"Forced Photometry"},{"children":[{"file":"crossmatch/ztf_ps1_crossmatch.md"}],"file":"crossmatch/README.md","title":"Crossmatch"}],"exports":[],"bibliography":[],"title":"The Fornax Initiative","index":"index","pages":[{"slug":"readme","title":"Time Domain","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"light-curve-collector","title":"Make Multi-Wavelength Light Curves Using Archival Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"scale-up","title":"Make Multi-Wavelength Light Curves for Large Samples","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"light-curve-classifier","title":"Light Curve Classifier","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ml-agnzoo","title":"AGN Zoo: Comparison of AGN selected with different metrics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-1","title":"Spectroscopy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"spectra-collector","title":"Extract Multi-Wavelength Spectroscopy from Archival Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-2","title":"Multi-band forced photometry","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"multiband-photometry","title":"Automated Multiband Forced Photometry on Large Datasets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-3","title":"Cross Matching","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ztf-ps1-crossmatch","title":"Cross-Match ZTF and Pan-STARRS using LSDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"789a585532eea976c41733805fb55161f3b36d1d02bdb0106a421fb30322fd28","slug":"spectra-collector","location":"/spectroscopy/spectra_collector.md","dependencies":[],"frontmatter":{"title":"Extract Multi-Wavelength Spectroscopy from Archival Data","kernelspec":{"name":"python3","display_name":"py-spectra_collector","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.17.2"}},"content_includes_title":false,"authors":[{"id":"Fornax developers and scientists","name":"Fornax developers and scientists"}],"github":"https://github.com/nasa-fornax/fornax-demo-notebooks","subject":"Fornax Demo Notebooks","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/nasa-fornax/fornax-demo-notebooks/blob/main/spectroscopy/spectra_collector.md","edit_url":"https://github.com/nasa-fornax/fornax-demo-notebooks/edit/main/spectroscopy/spectra_collector.md","exports":[{"format":"md","filename":"spectra_collector.md","url":"/fornax-demo-notebooks/build/spectra_collector-83c7f18422ab002307e8b5b1e83ccc26.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"n4DoefoXwd"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"wak6vF2hJ2"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"DjfIvgdAZ8"}],"key":"LW4PjADHBC"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"• automatically load a catalog of sources","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ODiVzQBrbv"}],"key":"Fg3tAPtUrF"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"• search NASA and non-NASA resources for fully reduced spectra and load them using specutils","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"qK70GeYifR"}],"key":"PMU4oWa3qn"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"• store the spectra in a Pandas multiindex dataframe","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"B2B3zaBSbM"}],"key":"NStpzIncZc"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"• plot all the spectra of a given source","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"nOvpqILjSs"}],"key":"lzs4IOaTOa"},{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"CVIqk3JRHM"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"FQkWfh6V05"},{"type":"heading","depth":3,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Motivation","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"JxwVQMm7Mf"}],"identifier":"motivation","label":"Motivation","html_id":"motivation","implicit":true,"key":"gF6VZRUmvj"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"A user has a source (or a sample of sources) for which they want to obtain spectra covering ranges\nof wavelengths from the UV to the far-IR. The large amount of spectra available enables\nmulti-wavelength spectroscopic studies, which is crucial to understand the physics of stars,\ngalaxies, and AGN. However, gathering and analysing spectra is a difficult endeavor as the spectra\nare distributed over different archives and in addition they have different formats which\ncomplicates their handling. This notebook showcases a tool for the user to conveniently query the\nspectral archives and collect the spectra for a set of objects in a format that can be read in\nusing common software such as the Python ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"MmLVAZHYdU"},{"type":"inlineCode","value":"specutils","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"bOjJjdXe8a"},{"type":"text","value":" package. For simplicity, we limit the tool to\nquery already reduced and calibrated spectra.\nThe notebook may focus on the COSMOS field for now, which has a large overlap of spectroscopic\nsurveys such as with SDSS, DESI, Keck, HST, JWST, Spitzer, and Herschel. In addition, the tool\nenables the capability to search and ingest spectra from Euclid and SPHEREx in the feature. For\nthis to work, the ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"QWvytzpo32"},{"type":"inlineCode","value":"specutils","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"DeLubg2PzX"},{"type":"text","value":" functions may have to be update or a wrapper has to be implemented.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"Tn88q9ChaP"}],"key":"ZSbFPXrj75"},{"type":"heading","depth":3,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"List of Spectroscopic Archives and Status","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"aA8jntb1jt"}],"identifier":"list-of-spectroscopic-archives-and-status","label":"List of Spectroscopic Archives and Status","html_id":"list-of-spectroscopic-archives-and-status","implicit":true,"key":"T7acFTsfkH"},{"type":"table","position":{"start":{"line":50,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Archive","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"rTRpDHjcdE"}],"key":"eDxmFZdeKp"},{"type":"tableCell","header":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Spectra","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"OZdsFX0dxM"}],"key":"M6KK0YJgJ5"},{"type":"tableCell","header":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"wZUq504Ev1"}],"key":"kZKblanFCA"},{"type":"tableCell","header":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Access point","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"uxo5YqLKne"}],"key":"kGfbSbbPb5"},{"type":"tableCell","header":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Status","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"NvaiD0W8ME"}],"key":"mlPcMCuac0"}],"key":"bW6BpFPGBC"},{"type":"tableRow","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"mad96Bpcqp"}],"key":"upXzaB6xRd"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Keck","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"j6y9cOUrgy"}],"key":"VTKIrTlxCA"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"About 10,000 spectra on the COSMOS field from ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"EoYrR7274N"},{"type":"link","url":"https://ui.adsabs.harvard.edu/abs/2018ApJ...858...77H/abstract","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Hasinger et al. (2018)","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"x97LU7dPUn"}],"urlSource":"https://ui.adsabs.harvard.edu/abs/2018ApJ...858...77H/abstract","key":"hwdKFVmpK2"}],"key":"gQHznsQLJU"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"link","url":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-scan?projshort=COSMOS","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"IRSA Archive","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"HmJcFWW4Bu"}],"urlSource":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-scan?projshort=COSMOS","key":"O1C80G3TwF"}],"key":"If2FSzQ3mZ"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"S1rn2cZxCr"},{"type":"inlineCode","value":"astroquery.ipac.irsa","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"bpJavVTTAS"},{"type":"text","value":". (Table gives URLs to spectrum FITS files.) Note: only implemented for absolute calibrated spectra.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"CJYOdCb98p"}],"key":"jVhHiH29Hs"}],"key":"nPIqD8NgNk"},{"type":"tableRow","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"EUW4St2Vfw"}],"key":"luL3NAWIVN"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Spitzer IRS","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"krj8tG7hVY"}],"key":"J3nwK555HZ"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"~17,000 merged low-resolution IRS spectra","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ZoVNPkRtzX"}],"key":"Yr4Gxm8m7g"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"link","url":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-dd?catalog=irs_enhv211","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"IRS Enhanced Product","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"XzMOr6n1wq"}],"urlSource":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-dd?catalog=irs_enhv211","key":"O1cwgjpMjv"}],"key":"TaHC9A1FFr"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Fx6lsGktPF"},{"type":"inlineCode","value":"astroquery.ipac.irsa","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"o39FyAzH30"},{"type":"text","value":". (Table gives URLs to spectrum IPAC tables.)","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"LmN6mIJ2Uu"}],"key":"U6PDPRADyW"}],"key":"LARcKoXiEl"},{"type":"tableRow","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"Hv5YWyxupW"}],"key":"ttTA5X9IQd"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"IRTF*","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"FTGqDgwUdI"}],"key":"r6mNiSFMMC"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Large library of stellar spectra","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"ucBgReZXe8"}],"key":"ybKBaPEbFs"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[],"key":"rRCHucAuKZ"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"does ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"ECXOuEJkxo"},{"type":"inlineCode","value":"astroquery.ipac.irsa","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"sliMq5Nrps"},{"type":"text","value":" work??","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"zOaBmelAnO"}],"key":"Dn8g9zVnR9"}],"key":"bQvmZ8km0P"},{"type":"tableRow","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"ESA","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"DsnypBU4JA"}],"key":"TvKzUBqRL7"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Herschel*","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"lmkNdqiXQ0"}],"key":"jz3slGdF72"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Some spectra","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"XOlrrb9v1i"}],"key":"DYxeWUZ7oL"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"astroquery.esa.hsa","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"QsnzgkKiMX"}],"key":"nIDPPqaLfB"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"implemented with ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"FhW0WYE3mc"},{"type":"link","url":"https://astroquery.readthedocs.io/en/latest/esa/hsa/hsa.html","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"astroquery","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"w2zKg69WiD"}],"urlSource":"https://astroquery.readthedocs.io/en/latest/esa/hsa/hsa.html","key":"gpw3NneiRe"}],"key":"VZTvsNk4T0"}],"key":"ViNLf2mNJm"},{"type":"tableRow","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"X3e8c8HzbY"}],"key":"xZPRw2gXQX"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Euclid","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"LFnvFiyASH"}],"key":"F53ZlmTrLA"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Spectra hosted at IRSA in FY25","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"toNIX8wl6A"}],"key":"BDsCbObqjJ"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[],"key":"YBKufElASu"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Using Q1 Spectra in the red grism (RGS) ingested in FY25, to be updated to DR1","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"BkQBIejKvQ"}],"key":"EedG3Fnxnk"}],"key":"Wd593nO3LZ"},{"type":"tableRow","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"KkERSWG3Er"}],"key":"ltLV2NzUgK"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"SPHEREx","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"TghXSHzElS"}],"key":"xoJizb8uHR"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Spectra/cubes will be hosted at IRSA, first release in FY25 -\u003e preparation for ingestion","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"lm9tKy8vsi"}],"key":"XTnYglHkXv"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[],"key":"FMtcCrXffG"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Will use mock spectra with correct format for testing","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Ame5xmf0i5"}],"key":"XuUDiAtKT7"}],"key":"y34TQzY4Ua"},{"type":"tableRow","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"MAST","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"k4cdnOnndr"}],"key":"A2Ui62EnON"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"HST*","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"chCoKKQ2b4"}],"key":"fped2uHH4n"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Slitless spectra would need reduction and extraction. There are some reduced slit spectra from COS in the Hubble Archive","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"qtNVHb0hJO"}],"key":"s8BRFq3x3O"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"KGsAOxsgWO"}],"key":"BylM1xEbry"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Implemented using ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"KHEgkZvHgl"},{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"SSCTrHgbBG"}],"key":"sqngtIMNKc"}],"key":"uDmKYg3TJF"},{"type":"tableRow","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"MAST","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"aQEHdsTdS2"}],"key":"kXAxVF9ZI1"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"JWST*","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Pjglmm82RS"}],"key":"Cj2US3epaP"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Reduced slit MSA and Slit spectra that can be queried","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"eycLa4MuGL"}],"key":"UZ5wzfPorA"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"dTpuk4gFgq"}],"key":"FPRNYGYZMp"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Implemented using ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"zj5WtzhHWY"},{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"DuzBWh2v6B"}],"key":"fFDov30hph"}],"key":"wKVmbvYPGs"},{"type":"tableRow","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"SDSS","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"gAJfe6MwQl"}],"key":"QEbURKLqk0"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"SDSS optical","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"ppKLRGsO9s"}],"key":"oWB5Uo36NB"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Optical spectra that are reduced","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"ChPoOQh0XT"}],"key":"oKL40Tt3kx"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"link","url":"https://skyserver.sdss.org/dr18/SearchTools","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Sky Server","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"WtpUiO7APd"}],"urlSource":"https://skyserver.sdss.org/dr18/SearchTools","key":"xEIyj4V1tC"},{"type":"text","value":" or ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"QqkMgxAogY"},{"type":"inlineCode","value":"astroquery.sdss","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"NdTbFQRKhG"},{"type":"text","value":" (preferred)","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"iasFSxk5ve"}],"key":"DoLqWxWYCY"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Implemented using ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Ad63NZGV0e"},{"type":"inlineCode","value":"astroquery.sdss","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"nrI42lTlWa"},{"type":"text","value":".","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"awJw0dpW2S"}],"key":"eKU7JT1LaN"}],"key":"FWy9Gzsguv"},{"type":"tableRow","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"DESI","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"FIaSTMr0AE"}],"key":"eVtY4ZxanK"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"DESI*","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"VGlP2g4Jxa"}],"key":"QyYoX0pzG3"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Optical spectra","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"W9Z7WJIccx"}],"key":"D1d5G27M2g"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"link","url":"https://data.desi.lbl.gov/public/","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"DESI public data release","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"lHabSWMMlC"}],"urlSource":"https://data.desi.lbl.gov/public/","key":"yzB9uCGIQN"}],"key":"PYyOne3dpj"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ilWPEkNKoB"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"PpS7YzD1aW"},{"type":"text","value":" library.  Currently commented out because ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fuQtOQFwEc"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"hgQAvyFEbO"},{"type":"text","value":" library is incompatible with numpy \u003e 2 which we need for other modules","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fwPpgu1Zoy"}],"key":"ZJGXnhvYIf"}],"key":"rvaiNrnk3S"},{"type":"tableRow","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"BOSS","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"ECb1kIOiy3"}],"key":"jzprO59JrO"},{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"BOSS*","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"Mfb69i7t8m"}],"key":"gbmy8sNUNW"},{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Optical spectra","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"dImcGecxak"}],"key":"btXMfXoiyV"},{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"link","url":"https://www.sdss4.org/surveys/boss/","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"BOSS webpage (part of SDSS)","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"U4eTx4IKDm"}],"urlSource":"https://www.sdss4.org/surveys/boss/","key":"s3OW1cF3Lk"}],"key":"xCDpqHkuBc"},{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"yNecsAwC8c"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"P6a3cAG3eu"},{"type":"text","value":" library together with DESI","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"yjZIYrtbUj"}],"key":"GbyFVBogNQ"}],"key":"mCmrrPtxkA"},{"type":"tableRow","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"HEASARC","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"FaxODPChvk"}],"key":"SqXTCEaUTF"},{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"None","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"TUdafOM4PD"}],"key":"weghWKETMa"},{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Could link to Chandra observations to check AGN occurrence.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"NjhIkoVfbS"}],"key":"Zko6vMH8Yh"},{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"inlineCode","value":"astroquery.heasarc","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"TlVYh3NzT8"}],"key":"un81dZLXQs"},{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"More thoughts on how to include scientifically.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"FjSWO5BBZq"}],"key":"MUO37FwXp4"}],"key":"UGV7kPDxAY"}],"key":"pY4GVzMb3x"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"The ones with an asterisk (*) are the challenging ones.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"O7KFw7W5AQ"}],"key":"t980SCiosv"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Input","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"CluFmsXOLd"}],"identifier":"input","label":"Input","html_id":"input","implicit":true,"key":"BU7rbAxuGb"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"• Coordinates for a single source or a sample on the COSMOS field","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"gdN2NXpDzJ"}],"key":"q6GEehfOnQ"},{"type":"heading","depth":3,"position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"Output","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"dq0lqDKuJf"}],"identifier":"output","label":"Output","html_id":"output","implicit":true,"key":"H7u8dSPNwT"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"• A Pandas data frame including the spectra from different facilities","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"iE5Io8p7Tx"}],"key":"gUIyeSPtTJ"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"• A plot comparing the different spectra extracted for each source","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"Qfvlnh0FDB"}],"key":"qV4GCCf80H"},{"type":"heading","depth":3,"position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Runtime","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"YTJ0B8HXVA"}],"identifier":"runtime","label":"Runtime","html_id":"runtime","implicit":true,"key":"VTyo0EY2eU"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"As of 2025 July, this notebook takes about 18 minutes to run to completion on Fornax using\na server with 16GB RAM/4 CPU’ and Environment: ‘Default Astrophysics’ (image).","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"H9UrYuAV3y"}],"key":"FviJ84QDvO"}],"key":"iiM8505h09"},{"type":"block","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Datasets that were considered but didn’t end up being used","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"QsXmyb9UiZ"}],"identifier":"datasets-that-were-considered-but-didnt-end-up-being-used","label":"Datasets that were considered but didn’t end up being used","html_id":"datasets-that-were-considered-but-didnt-end-up-being-used","implicit":true,"key":"CXrDRt9IPD"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"IRTF:","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"HJnomVSlEE"}],"key":"QHmq0ewtA2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":87,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://irsa.ipac.caltech.edu/Missions/irtf.html","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"https://​irsa​.ipac​.caltech​.edu​/Missions​/irtf​.html","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Cw0Gde87WN"}],"urlSource":"https://irsa.ipac.caltech.edu/Missions/irtf.html","key":"nMY2ABxEx4"}],"key":"JcdVze8NT1"}],"key":"S0cQv6i9uj"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The IRTF is a 3.2 meter telescope, optimized for infrared observations, and located at the summit\nof Mauna Kea, Hawaiʻi.","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"InCEKJ1dAX"}],"key":"YDDrtvOd6q"}],"key":"KgufG7pp2f"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"large library of stellar spectra","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"q7AmRBmN45"}],"key":"xsaEDqNsMv"}],"key":"E9BWEkNaYH"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Not included here because the data are not currently available in an easily accessible,\nsearchable format","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"ie5HEgmflu"}],"key":"JyFTqod9xI"}],"key":"aZQs1aWYN8"}],"key":"ekTrOzjzST"},{"type":"heading","depth":2,"position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"kkgCnvN4gF"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"jgrg4WY0Vm"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"This cell will install them if needed:","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"xORwZr6ZCq"}],"key":"iRa9KGadFR"}],"key":"rcTCpGyAWF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# %pip install -r requirements_spectra_collector.txt","key":"gXNdTLrkPB"},{"type":"output","id":"v5UI01dp_gMm8ROhcgeDu","data":[],"key":"HR0wWCxdri"}],"key":"Q5AnxSHrpx"},{"type":"block","children":[],"key":"s886EbZxy3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport sys\n\nimport astropy.units as u\nfrom astropy.coordinates import SkyCoord\nfrom astropy.table import Table\nfrom astropy.utils.data import conf\n\nsys.path.append('code_src/')\nfrom data_structures_spec import MultiIndexDFObject\n#from desi_functions import DESIBOSS_get_spec\nfrom herschel_functions import Herschel_get_spec\nfrom keck_functions import KeckDEIMOS_get_spec\nfrom mast_functions import HST_get_spec, JWST_get_spec\nfrom plot_functions import create_figures\nfrom sample_selection import clean_sample\nfrom sdss_functions import SDSS_get_spec\nfrom spitzer_functions import SpitzerIRS_get_spec\nfrom euclid_functions import euclid_get_spec\n\n# The Euclid spectrum files are large and the time it takes to read\n# them can exceed astropy's default timeout limit. Increase it.\nconf.remote_timeout = 120","key":"rOub322eoo"},{"type":"output","id":"sSKFwXApglVbdehNjpL8_","data":[],"key":"qC5cf9jJKt"}],"key":"LykUydrj7i"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"1. Define the sample","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"WMKXvtFz81"}],"identifier":"id-1-define-the-sample","label":"1. Define the sample","html_id":"id-1-define-the-sample","implicit":true,"key":"ESoqvHyQP0"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Here we will define the sample of galaxies. For now, we just enter some “random” coordinates to\ntest the code.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"DkLH9HLC69"}],"key":"YTJRtc4037"}],"key":"g9YC5SKTCm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coords = []\nlabels = []\n\ncoords.append(SkyCoord(\"{} {}\".format(\"09 54 49.40\", \"+09 16 15.9\"), unit=(u.hourangle, u.deg)))\nlabels.append(\"NGC3049\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"12 45 17.44 \", \"27 07 31.8\"), unit=(u.hourangle, u.deg)))\nlabels.append(\"NGC4670\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"14 01 19.92\", \"−33 04 10.7\"), unit=(u.hourangle, u.deg)))\nlabels.append(\"Tol_89\")\n\ncoords.append(SkyCoord(233.73856, 23.50321, unit=u.deg))\nlabels.append(\"Arp220\")\n\ncoords.append(SkyCoord(150.091, 2.2745833, unit=u.deg))\nlabels.append(\"COSMOS1\")\n\ncoords.append(SkyCoord(150.1024475, 2.2815559, unit=u.deg))\nlabels.append(\"COSMOS2\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"150.000\", \"+2.00\"), unit=(u.deg, u.deg)))\nlabels.append(\"COSMOS3\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"+53.15508\", \"-27.80178\"), unit=(u.deg, u.deg)))\nlabels.append(\"JADESGS-z7-01-QU\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"+53.15398\", \"-27.80095\"), unit=(u.deg, u.deg)))\nlabels.append(\"TestJWST\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"268.48058743\", \"64.78064676\"), unit=(u.deg, u.deg)))\nlabels.append(\"TestEuclid\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"+150.33622\", \"+55.89878\"), unit=(u.deg, u.deg)))\nlabels.append(\"Twin Quasar\")\n\nsample_table = clean_sample(coords, labels, precision=2.0 * u.arcsecond, verbose=1)","key":"PRv33oTV08"},{"type":"output","id":"Fzom0sN7thhPDkCvomKWr","data":[{"output_type":"stream","name":"stdout","text":"after duplicates removal, sample size: 11\n"}],"key":"J1Y444XV3j"}],"key":"GDbMrOyP1b"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"1.2 Write out your sample to disk","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"UN3TzocFT3"}],"identifier":"id-1-2-write-out-your-sample-to-disk","label":"1.2 Write out your sample to disk","html_id":"id-1-2-write-out-your-sample-to-disk","implicit":true,"key":"xX46vLZQlq"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"At this point you may wish to write out your sample to disk and reuse that in future work sessions,\ninstead of creating it from scratch again. Note that we first check if the ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"Wg8JfENu88"},{"type":"inlineCode","value":"data","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"RSvjp5quhx"},{"type":"text","value":" directory exists\nand if not, we will create one.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"vrCAr8PWFU"}],"key":"wIAnSXXwpc"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"For the format of the save file, we would suggest to choose from various formats that fully support\nastropy objects(eg., SkyCoord).  One example that works is Enhanced Character-Separated Values or\n","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"BFsCyvaj1H"},{"type":"link","url":"https://docs.astropy.org/en/stable/io/ascii/ecsv.html","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"‘ecsv’","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"KXJ1sfn9bx"}],"urlSource":"https://docs.astropy.org/en/stable/io/ascii/ecsv.html","key":"yretvHuQ5R"}],"key":"oRIH7erPoz"}],"key":"ov0daqyrxH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if not os.path.exists(\"./data\"):\n    os.mkdir(\"./data\")\nsample_table.write('data/input_sample.ecsv', format='ascii.ecsv', overwrite=True)","key":"EYmOhw9Lvu"},{"type":"output","id":"-iSzk4VETh2jHUoN8nh8s","data":[],"key":"ZjOXJPxnYx"}],"key":"qy153MYKt9"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"1.3 Load the sample table from disk","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"qTvtD6Wx9i"}],"identifier":"id-1-3-load-the-sample-table-from-disk","label":"1.3 Load the sample table from disk","html_id":"id-1-3-load-the-sample-table-from-disk","implicit":true,"key":"sQRLP8NfV9"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Do only this step from this section when you have a previously generated sample table","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"PHjMeAvCQu"}],"key":"krfgbwLVu0"}],"key":"SrJY3dRDeS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sample_table = Table.read('data/input_sample.ecsv', format='ascii.ecsv')","key":"bK3eNUociv"},{"type":"output","id":"Bf1PP6kCfGlVft9qS7-8m","data":[],"key":"GFc0oJMLFD"}],"key":"QgWDxOs77l"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"1.4 Initialize data structure to hold the spectra","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"jcd23j37xW"}],"identifier":"id-1-4-initialize-data-structure-to-hold-the-spectra","label":"1.4 Initialize data structure to hold the spectra","html_id":"id-1-4-initialize-data-structure-to-hold-the-spectra","implicit":true,"key":"gYc3980W60"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Here, we initialize the MultiIndex data structure that will hold the spectra.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"HiXOm0bks2"}],"key":"nEpz6yq7IY"}],"key":"DBczmbvqWE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_spec = MultiIndexDFObject()","key":"lzyGpXTq7S"},{"type":"output","id":"HZefwZYq54qCzsdiHjoNP","data":[],"key":"D8Zqe5D3OD"}],"key":"PhlVsfmRbq"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"2. Find spectra for these targets in NASA and other ancillary catalogs","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"KkgE8THegh"}],"identifier":"id-2-find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs","label":"2. Find spectra for these targets in NASA and other ancillary catalogs","html_id":"id-2-find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs","implicit":true,"key":"mAebxDEKhK"},{"type":"paragraph","position":{"start":{"line":208,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"We search a curated list of NASA astrophysics archives.  Because each archive is different, and in\nmany cases each catalog is different, each function to access a catalog is necesarily specialized\nto the location and format of that particular catalog.","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"fOivpFtFeE"}],"key":"H2uxn0oC2y"}],"key":"dKycrVOflX"},{"type":"block","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"2.1 IRSA Archive","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"xbNlKoDayW"}],"identifier":"id-2-1-irsa-archive","label":"2.1 IRSA Archive","html_id":"id-2-1-irsa-archive","implicit":true,"key":"gUAyPTy6TA"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"This archive includes spectra taken by","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ZlBvCAtkdF"}],"key":"bXeHlNKMLP"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"• Keck","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"TMkeXvF6RZ"}],"key":"hVYdrVbdrY"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"• Spitzer/IRS","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"bWvWqSDNZv"}],"key":"fApxYoo3iz"},{"type":"paragraph","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"• Euclid/NISP","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"pgGg6ymJVD"}],"key":"yKAc3PUBVB"}],"key":"fpp6g7hzT9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# Get Keck Spectra (COSMOS only)\ndf_spec_DEIMOS = KeckDEIMOS_get_spec(sample_table=sample_table, search_radius_arcsec=1)\ndf_spec.append(df_spec_DEIMOS)","key":"TrW2rH1Gxq"},{"type":"output","id":"dAQdzm03gqJSbvkQ06NMk","data":[{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 1\nno calibration is available\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 1\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nCPU times: user 315 ms, sys: 10.4 ms, total: 326 ms\nWall time: 21.1 s\n"}],"key":"gr6km6vYFp"}],"key":"LFGI7XtECo"},{"type":"block","children":[],"key":"fiPjFe2mdm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# Get Spitzer IRS Spectra\ndf_spec_IRS = SpitzerIRS_get_spec(sample_table, search_radius_arcsec=1, COMBINESPEC=False)\ndf_spec.append(df_spec_IRS)","key":"GR0saW5U8Q"},{"type":"output","id":"M35ESxHj3V9eLJAgwVaUx","data":[{"output_type":"stream","name":"stdout","text":"Processing source NGC3049\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source NGC4670\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source Tol_89\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source Arp220\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 8\nMore than 1 entry found - pick the closest\n"},{"output_type":"stream","name":"stdout","text":"Processing source COSMOS1\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source COSMOS2\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source COSMOS3\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source JADESGS-z7-01-QU\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source TestJWST\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source TestEuclid\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source Twin Quasar\n"},{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nCPU times: user 430 ms, sys: 10.8 ms, total: 441 ms\nWall time: 20.8 s\n"}],"key":"lYvjla9KK5"}],"key":"KlYOU2tSx2"},{"type":"block","children":[],"key":"MSMk88Hon3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# Get Euclid Spectra\ndf_spec_Euclid = euclid_get_spec(sample_table=sample_table, search_radius_arcsec=1)\ndf_spec.append(df_spec_Euclid)","key":"xsdVH1iEjG"},{"type":"output","id":"d0RYoFo8PdNYvszzT41Cu","data":[{"output_type":"stream","name":"stdout","text":"Processing source NGC3049\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for NGC3049.\nProcessing source NGC4670\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for NGC4670.\nProcessing source Tol_89\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for Tol_89.\nProcessing source Arp220\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for Arp220.\nProcessing source COSMOS1\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for COSMOS1.\nProcessing source COSMOS2\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for COSMOS2.\nProcessing source COSMOS3\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for COSMOS3.\nProcessing source JADESGS-z7-01-QU\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for JADESGS-z7-01-QU.\nProcessing source TestJWST\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for TestJWST.\nProcessing source TestEuclid\n"},{"output_type":"stream","name":"stdout","text":"Found Euclid object_id: 2684805874647806467\n"},{"output_type":"stream","name":"stdout","text":"Processing source Twin Quasar\n"},{"output_type":"stream","name":"stdout","text":"No match found in Euclid MER catalog for Twin Quasar.\nCPU times: user 2.14 s, sys: 85 ms, total: 2.22 s\nWall time: 36.2 s\n"}],"key":"hfmLbmHRm8"}],"key":"Cn8g3HinWL"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"2.2 MAST Archive","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"AYJhOTzYQt"}],"identifier":"id-2-2-mast-archive","label":"2.2 MAST Archive","html_id":"id-2-2-mast-archive","implicit":true,"key":"YzN6c2SkCC"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"This archive includes spectra taken by","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"yFAZpoIkbi"}],"key":"X2b6telltS"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"• HST (including slit spectroscopy)","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"Hyjw5cs5yx"}],"key":"vOzqFx9jUm"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"• JWST (including MSA and slit spectroscopy)","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"iloynfW5JH"}],"key":"H82diXFQ0n"}],"key":"WzAdpIUc9m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# Get Spectra for HST\ndf_spec_HST = HST_get_spec(\n    sample_table,\n    search_radius_arcsec=0.5,\n    datadir=\"./data/\",\n    verbose=False,\n    delete_downloaded_data=True\n)\ndf_spec.append(df_spec_HST)","key":"VPzeLsftDc"},{"type":"output","id":"hkpQU7sOVQrtBhVtb3dj8","data":[{"output_type":"stream","name":"stdout","text":"Processing source NGC3049\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 9\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 4\n"},{"output_type":"stream","name":"stdout","text":"Processing source NGC4670\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 6\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 2\n"},{"output_type":"stream","name":"stdout","text":"Processing source Tol_89\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 9\nNumber of files to download: 3\n"},{"output_type":"stream","name":"stdout","text":"Processing source Arp220\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Arp220 could not be found\nProcessing source COSMOS1\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 4\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source COSMOS1.\nProcessing source COSMOS2\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 3\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source COSMOS2.\nProcessing source COSMOS3\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 1\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source COSMOS3.\nProcessing source JADESGS-z7-01-QU\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 97\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source JADESGS-z7-01-QU.\nProcessing source TestJWST\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 93\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source TestJWST.\nProcessing source TestEuclid\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource TestEuclid could not be found\nProcessing source Twin Quasar\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 6\n"},{"output_type":"stream","name":"stdout","text":"Number of files to download: 2\n"},{"output_type":"stream","name":"stdout","text":"CPU times: user 2.57 s, sys: 55.3 ms, total: 2.63 s\nWall time: 2min 45s\n"}],"key":"TBAymj7Ts6"}],"key":"IzcFtAr6wO"},{"type":"block","children":[],"key":"D5FWGSkm2h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# Get Spectra for JWST\ndf_jwst = JWST_get_spec(\n    sample_table,\n    search_radius_arcsec=0.5,\n    verbose=False,\n    max_spectra_per_source = 5\n)\ndf_spec.append(df_jwst)","key":"CQENL6909O"},{"type":"output","id":"7T9eEaKZV2PLvdO0SLfXg","data":[{"output_type":"stream","name":"stdout","text":"Searching Spectra in the cloud... \nINFO: Using the S3 STScI public dataset [astroquery.mast.cloud]\nProcessing source NGC3049\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource NGC3049 could not be found\nProcessing source NGC4670\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource NGC4670 could not be found\nProcessing source Tol_89\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Tol_89 could not be found\nProcessing source Arp220\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Arp220 could not be found\nProcessing source COSMOS1\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource COSMOS1 could not be found\nProcessing source COSMOS2\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 2\n"},{"output_type":"stream","name":"stdout","text":"Number of files found: 12\nLimiting to first 5 spectra for source COSMOS2.\n"},{"output_type":"stream","name":"stderr","text":"WARNING: NoResultsWarning: Unable to locate file jwst/public/jw02565/jw02565001001/jw02565001001_03101_00004_nrs2_x1d.fits. [astroquery.mast.cloud]\nWARNING: NoResultsWarning: Unable to locate file jwst/public/jw02565/jw02565001001/jw02565001001_03101_00003_nrs2_x1d.fits. [astroquery.mast.cloud]\n"},{"output_type":"stream","name":"stdout","text":"Skipping jw02565001001_03101_00004_nrs2_x1d.fits: not available in cloud.\nSkipping jw02565001001_03101_00003_nrs2_x1d.fits: not available in cloud.\n"},{"output_type":"stream","name":"stdout","text":"Processing source COSMOS3\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource COSMOS3 could not be found\nProcessing source JADESGS-z7-01-QU\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 18\n"},{"output_type":"stream","name":"stdout","text":"Number of files found: 612\nLimiting to first 5 spectra for source JADESGS-z7-01-QU.\n"},{"output_type":"stream","name":"stdout","text":"Processing source TestJWST\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 6\n"},{"output_type":"stream","name":"stdout","text":"Number of files found: 630\nLimiting to first 5 spectra for source TestJWST.\n"},{"output_type":"stream","name":"stdout","text":"Processing source TestEuclid\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource TestEuclid could not be found\nProcessing source Twin Quasar\n"},{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Twin Quasar could not be found\ndone\nGrouping Spectra... \nGrouping object COSMOS2\nGrouping object JADESGS-z7-01-QU\nGrouping object TestJWST\ndone\nCPU times: user 10.6 s, sys: 881 ms, total: 11.5 s\nWall time: 3min 2s\n"}],"key":"ceBIxDJ1x9"}],"key":"B874AViZSM"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"2.3 ESA Archive","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"HvKVEu7Xts"}],"identifier":"id-2-3-esa-archive","label":"2.3 ESA Archive","html_id":"id-2-3-esa-archive","implicit":true,"key":"GOAAZjNNcq"}],"key":"oFOVJjD2lz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Herschel PACS \u0026 SPIRE from ESA TAP using astroquery\n# This search is fully functional, but is commented out because it takes\n# ~4 hours to run to completion\nherschel_radius = 1.1\nherschel_download_directory = 'data/herschel'\n\n# if not os.path.exists(herschel_download_directory):\n#    os.makedirs(herschel_download_directory, exist_ok=True)\n# df_spec_herschel =  Herschel_get_spec(sample_table, herschel_radius, herschel_download_directory, delete_downloaded_data=True)\n# df_spec.append(df_spec_herschel)","key":"mS4qQT6ded"},{"type":"output","id":"LvGdliMgvKy9m32UdMfxR","data":[],"key":"tHGS4Dbv4g"}],"key":"rRvCUk5xo7"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"2.4 SDSS Archive","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"HNH4bZeIff"}],"identifier":"id-2-4-sdss-archive","label":"2.4 SDSS Archive","html_id":"id-2-4-sdss-archive","implicit":true,"key":"XO783dKeKk"}],"key":"uNvhZefjgc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# Get SDSS Spectra\ndf_spec_SDSS = SDSS_get_spec(sample_table, search_radius_arcsec=5, data_release=17)\ndf_spec.append(df_spec_SDSS)","key":"JWVaruWLv7"},{"type":"output","id":"0YwA9wcX8_dG8F1Hwkhj0","data":[{"output_type":"stream","name":"stdout","text":"Source Tol_89 could not be found\n"},{"output_type":"stream","name":"stdout","text":"Source COSMOS1 could not be found\nSource COSMOS2 could not be found\nSource COSMOS3 could not be found\nSource JADESGS-z7-01-QU could not be found\nSource TestJWST could not be found\n"},{"output_type":"stream","name":"stdout","text":"Source TestEuclid could not be found\n"},{"output_type":"stream","name":"stdout","text":"CPU times: user 149 ms, sys: 16.2 ms, total: 166 ms\nWall time: 2.81 s\n"}],"key":"k0KXOjHt5W"}],"key":"Bcu5d2mZjz"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"2.5 DESI Archive","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"gvC0KtWtC2"}],"identifier":"id-2-5-desi-archive","label":"2.5 DESI Archive","html_id":"id-2-5-desi-archive","implicit":true,"key":"KaI6ajIEvv"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"This includes DESI spectra. Here, we use the ","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"ULGhC8aboK"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"sE4g5S5JsZ"},{"type":"text","value":" query. Note that this can also be used\nfor SDSS searches, however, according to the SPARCL webpage, only up to DR16 is included.\nTherefore, we will not include SDSS DR16 here (this is treated in the SDSS search above).","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"UVZnZbj79R"}],"key":"ZohCES9UO2"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"The DESI search is currently commented out because ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"XlfYCe9CM6"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"VntkYlpuWw"},{"type":"text","value":" is not compatible with numpy \u003e 2 which we require for the other modules to run.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"IxrE906bjR"}],"key":"zS3QBo6xb1"}],"key":"OyvgoIAnyQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#%%time\n## Get DESI and BOSS spectra with SPARCL\n#df_spec_DESIBOSS = DESIBOSS_get_spec(sample_table, search_radius_arcsec=5)\n#df_spec.append(df_spec_DESIBOSS)","key":"bqZI0SONxL"},{"type":"output","id":"Gjk0GIv6ldBEmkf-Edf_F","data":[],"key":"DzPZdpOrqF"}],"key":"KZnZr2vKzq"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"children":[{"type":"text","value":"3. Make plots of luminosity as a function of time","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"wxR9vgYBWF"}],"identifier":"id-3-make-plots-of-luminosity-as-a-function-of-time","label":"3. Make plots of luminosity as a function of time","html_id":"id-3-make-plots-of-luminosity-as-a-function-of-time","implicit":true,"key":"RUUFBRBM96"},{"type":"paragraph","position":{"start":{"line":319,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"We show flux in mJy as a function of time for all available bands for each object.\n","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"KhzzmrqJRE"},{"type":"inlineCode","value":"show_nbr_figures","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"yR25rIbFOh"},{"type":"text","value":" controls how many plots are actually generated and returned to the screen.\nIf you choose to save the plots with ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"FKGe5rIPUw"},{"type":"inlineCode","value":"save_output","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"lex110exHc"},{"type":"text","value":", they will be put in the output directory and\nlabelled by sample number.","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"sTOU8t7NGk"}],"key":"t1lKxqdvgv"}],"key":"DHGgHF3CZM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"### Plotting ####\ncreate_figures(df_spec=df_spec,\n               bin_factor=1,\n               show_nbr_figures=10,\n               save_output=False,\n               )","key":"zfHP2JRd7b"},{"type":"output","id":"lFLC0dFbAfBiuYdv7Sx-K","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d38ce462e66bf90a39dfd489574e22bb","path":"/fornax-demo-notebooks/build/d38ce462e66bf90a39dfd489574e22bb.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"dbff4ce61f40d0444294fd591084e8e8","path":"/fornax-demo-notebooks/build/dbff4ce61f40d0444294fd591084e8e8.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"68209f3d54df12fa9c48f2b27ebd1b60","path":"/fornax-demo-notebooks/build/68209f3d54df12fa9c48f2b27ebd1b60.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"60e1a126343e69571fc3179bb46ff5f7","path":"/fornax-demo-notebooks/build/60e1a126343e69571fc3179bb46ff5f7.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"116f880658646a698c7de2b52633fcfe","path":"/fornax-demo-notebooks/build/116f880658646a698c7de2b52633fcfe.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7ff530544305bdd7270f38ec4ea9fdfc","path":"/fornax-demo-notebooks/build/7ff530544305bdd7270f38ec4ea9fdfc.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f94d78d26afbee56681b3414d51326c0","path":"/fornax-demo-notebooks/build/f94d78d26afbee56681b3414d51326c0.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"34a7f9b7d39994a07524fb4d85df5c70","path":"/fornax-demo-notebooks/build/34a7f9b7d39994a07524fb4d85df5c70.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 900x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"636d7942d8d9bd566a3ad7fd1410a061","path":"/fornax-demo-notebooks/build/636d7942d8d9bd566a3ad7fd1410a061.png"}}}],"key":"TwslcyeCZv"}],"key":"Lyj0aj9HC4"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"About this notebook","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"MEt5yipDIY"}],"identifier":"about-this-notebook","label":"About this notebook","html_id":"about-this-notebook","implicit":true,"key":"Zkmj08UHG3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":335,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"Authors:","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"QteEKDW34m"}],"key":"JP2V38uTvD"},{"type":"text","value":" Andreas Faisst, Jessica Krick, Shoubaneh Hemmati, Troy Raen, Brigitta Sipőcz, David Shupe, and the Fornax team","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"eD9RprqBDC"}],"key":"gxNFP4z6kW"}],"key":"LpD2tdjCVl"},{"type":"listItem","spread":true,"position":{"start":{"line":336,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"nGDJUHdOOw"}],"key":"NCkqiioSUw"},{"type":"text","value":" For help with this notebook, please open a topic in the ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"EqAu6dUMxU"},{"type":"link","url":"https://discourse.fornax.sciencecloud.nasa.gov/","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"Fornax Community Forum","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"jRL51npjBz"}],"urlSource":"https://discourse.fornax.sciencecloud.nasa.gov/","key":"Q2gJUVRQ2Z"},{"type":"text","value":" “Support” category.","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"wOihm8XMIP"}],"key":"GiZvsDdMIQ"}],"key":"fkEUoHqpoF"}],"key":"ddRGNFRS3H"},{"type":"heading","depth":3,"position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Acknowledgements","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"LJuQHhHx27"}],"identifier":"acknowledgements","label":"Acknowledgements","html_id":"acknowledgements","implicit":true,"key":"u619a8Ov6B"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"AI: This notebook was created with assistance from OpenAI’s ChatGPT o4-mini-high model.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"z8orMLm5yU"}],"key":"knDUdRmy2z"}],"key":"XCCyq95orT"}],"key":"xiMAWckKl4"}],"key":"LbTLhQvJXJ"}],"key":"N3ii7rqjBd"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Spectroscopy","url":"/readme-1","group":"The Fornax Initiative"},"next":{"title":"Multi-band forced photometry","url":"/readme-2","group":"The Fornax Initiative"}}},"domain":"http://localhost:3000"},"project":{"subject":"Fornax Demo Notebooks","settings":{"output_matplotlib_strings":"remove"},"description":"Tutorial notebooks for example Fornax use cases","authors":[{"id":"Fornax developers and scientists","name":"Fornax developers and scientists"}],"github":"https://github.com/nasa-fornax/fornax-demo-notebooks","keywords":["astronomy"],"references":{"fornax-docs":{"url":"https://docs.fornax.sciencecloud.nasa.gov"}},"toc":[{"file":"index.md"},{"children":[{"file":"light_curves/light_curve_collector.md"},{"file":"light_curves/scale_up.md"},{"file":"light_curves/light_curve_classifier.md"},{"file":"light_curves/ML_AGNzoo.md"}],"file":"light_curves/README.md","title":"Light Curves"},{"children":[{"file":"spectroscopy/spectra_collector.md"}],"file":"spectroscopy/README.md","title":"Spectroscopy"},{"children":[{"file":"forced_photometry/multiband_photometry.md"}],"file":"forced_photometry/README.md","title":"Forced Photometry"},{"children":[{"file":"crossmatch/ztf_ps1_crossmatch.md"}],"file":"crossmatch/README.md","title":"Crossmatch"}],"exports":[],"bibliography":[],"title":"The Fornax Initiative","index":"index","pages":[{"slug":"readme","title":"Time Domain","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"light-curve-collector","title":"Make Multi-Wavelength Light Curves Using Archival Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"scale-up","title":"Make Multi-Wavelength Light Curves for Large Samples","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"light-curve-classifier","title":"Light Curve Classifier","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ml-agnzoo","title":"AGN Zoo: Comparison of AGN selected with different metrics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-1","title":"Spectroscopy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"spectra-collector","title":"Extract Multi-Wavelength Spectroscopy from Archival Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-2","title":"Multi-band forced photometry","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"multiband-photometry","title":"Automated Multiband Forced Photometry on Large Datasets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"readme-3","title":"Cross Matching","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ztf-ps1-crossmatch","title":"Cross-Match ZTF and Pan-STARRS using LSDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/fornax-demo-notebooks/build/manifest-06410F0D.js";
import * as route0 from "/fornax-demo-notebooks/build/root-ZJZ4LRPY.js";
import * as route1 from "/fornax-demo-notebooks/build/routes/$-23AHH5XS.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/fornax-demo-notebooks/build/entry.client-UNPC4GT3.js");</script></body></html>
{"version":3,"kind":"Notebook","sha256":"6dae7f840cd46fc6be4cb20066e1316342957cff59ad6b26ffa43ef729d2a425","slug":"spectra-collector","location":"/spectroscopy/spectra_collector.md","dependencies":[],"frontmatter":{"title":"Extract Multi-Wavelength Spectroscopy from Archival Data","kernelspec":{"name":"python3","display_name":"py-spectra_collector","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.18.1"}},"content_includes_title":false,"authors":[{"id":"Fornax developers and scientists","name":"Fornax developers and scientists"}],"github":"https://github.com/nasa-fornax/fornax-demo-notebooks","subject":"Fornax Demo Notebooks","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/nasa-fornax/fornax-demo-notebooks/blob/main/spectroscopy/spectra_collector.md","edit_url":"https://github.com/nasa-fornax/fornax-demo-notebooks/edit/main/spectroscopy/spectra_collector.md","exports":[{"format":"md","filename":"spectra_collector.md","url":"/fornax-demo-notebooks/build/spectra_collector-5740167ac7184cf75f3fb44076edf864.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"FcbqUeWNuD"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"g43NKyqwG2"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"yL5Z5tfujd"}],"key":"rTF0B4NNzy"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"• automatically load a catalog of sources","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"vhVgtmIVXO"}],"key":"ij0Eqswcsh"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"• search NASA and non-NASA resources for fully reduced spectra and load them using specutils","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"vArqGsT4QG"}],"key":"AgyWWkzWJe"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"• store the spectra in a Pandas multiindex dataframe","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"i4Vs5q3UVG"}],"key":"gSeWf6f27Q"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"• plot all the spectra of a given source","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"QV6eXMY3nK"}],"key":"RKmwo9ExOG"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"tp7Qp2QiM5"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"uAe8XmqnqX"},{"type":"heading","depth":3,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Motivation","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"LHst4jMTt4"}],"identifier":"motivation","label":"Motivation","html_id":"motivation","implicit":true,"key":"vvK4O7wuIh"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"A user has a source (or a sample of sources) for which they want to obtain spectra covering ranges\nof wavelengths from the UV to the far-IR. The large amount of spectra available enables\nmulti-wavelength spectroscopic studies, which is crucial to understand the physics of stars,\ngalaxies, and AGN. However, gathering and analysing spectra is a difficult endeavor as the spectra\nare distributed over different archives and in addition they have different formats which\ncomplicates their handling. This notebook showcases a tool for the user to conveniently query the\nspectral archives and collect the spectra for a set of objects in a format that can be read in\nusing common software such as the Python ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"WsfJz0VaZ6"},{"type":"inlineCode","value":"specutils","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"IuJe6DnNFp"},{"type":"text","value":" package. For simplicity, we limit the tool to\nquery already reduced and calibrated spectra.\nThe notebook may focus on the COSMOS field for now, which has a large overlap of spectroscopic\nsurveys such as with SDSS, DESI, Keck, HST, JWST, Spitzer, and Herschel. In addition, the tool\nenables the capability to search and ingest spectra from Euclid and SPHEREx in the feature. For\nthis to work, the ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"hgrygalurl"},{"type":"inlineCode","value":"specutils","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"j14aMgaoOi"},{"type":"text","value":" functions may have to be update or a wrapper has to be implemented.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"P16BCWsKcf"}],"key":"lqRG6CCLSc"},{"type":"heading","depth":3,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"List of Spectroscopic Archives and Status","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"HQCBa3pBdq"}],"identifier":"list-of-spectroscopic-archives-and-status","label":"List of Spectroscopic Archives and Status","html_id":"list-of-spectroscopic-archives-and-status","implicit":true,"key":"AyWcTt8M8H"},{"type":"table","position":{"start":{"line":48,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Archive","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Uo5RjQidUi"}],"key":"Lpw0jpEYQD"},{"type":"tableCell","header":true,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Spectra","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"mwgujlrS4K"}],"key":"U746DL8AtY"},{"type":"tableCell","header":true,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"uZCwkKvBEp"}],"key":"RgRTARpKvh"},{"type":"tableCell","header":true,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Access point","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"vu50kdEah6"}],"key":"jUJv5CYgGw"},{"type":"tableCell","header":true,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Status","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"cpP57KSuTL"}],"key":"RmASWV7h7l"}],"key":"pnL0SxuGJ6"},{"type":"tableRow","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"Oc5R8VB9pI"}],"key":"QFs6MyJhkg"},{"type":"tableCell","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Keck","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"LPKXDrTmmI"}],"key":"lmNiZulpbO"},{"type":"tableCell","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"About 10,000 spectra on the COSMOS field from ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"JbKsjFKlOC"},{"type":"link","url":"https://ui.adsabs.harvard.edu/abs/2018ApJ...858...77H/abstract","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Hasinger et al. (2018)","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"nPmbZNxxyT"}],"urlSource":"https://ui.adsabs.harvard.edu/abs/2018ApJ...858...77H/abstract","key":"Q2jFrfOyld"}],"key":"dYdV2sjtDX"},{"type":"tableCell","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"link","url":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-scan?projshort=COSMOS","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"IRSA Archive","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"QQT9Ml85jp"}],"urlSource":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-scan?projshort=COSMOS","key":"UIupgMIaCA"}],"key":"swZtJvfJq6"},{"type":"tableCell","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"FjqRYZpiCi"},{"type":"inlineCode","value":"astroquery.ipac.irsa","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"xzcZJ8udqC"},{"type":"text","value":". (Table gives URLs to spectrum FITS files.) Note: only implemented for absolute calibrated spectra.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"wSGtgcLop2"}],"key":"SMgOOda1oE"}],"key":"CYtTaai4Bv"},{"type":"tableRow","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"dCdxpmAMqy"}],"key":"ryNK22Q4Sz"},{"type":"tableCell","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Spitzer IRS","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"OHv9pfi3ic"}],"key":"M5UDD63qEU"},{"type":"tableCell","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"~17,000 merged low-resolution IRS spectra","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"gQduogFK74"}],"key":"D91Le9Qacq"},{"type":"tableCell","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"link","url":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-dd?catalog=irs_enhv211","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"IRS Enhanced Product","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"cKqNHt9EQu"}],"urlSource":"https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-dd?catalog=irs_enhv211","key":"i0bGg1i50e"}],"key":"WufuXpKfnO"},{"type":"tableCell","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"YqdWuN9CMH"},{"type":"inlineCode","value":"astroquery.ipac.irsa","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"u8G9HwqPpj"},{"type":"text","value":". (Table gives URLs to spectrum IPAC tables.)","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"Ej6jHSwhqP"}],"key":"jmwJoMmZ5v"}],"key":"ssCBJeVi91"},{"type":"tableRow","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"NeKovcurPg"}],"key":"pl7bH48rlz"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"IRTF*","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"EFIHCI9Cmn"}],"key":"NIegKSchjH"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Large library of stellar spectra","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"aLWYbng5YM"}],"key":"CV5Bswba6x"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[],"key":"ga7LKhBbHG"},{"type":"tableCell","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"does ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"MEQ4vBKsfC"},{"type":"inlineCode","value":"astroquery.ipac.irsa","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"aM5SW78p5D"},{"type":"text","value":" work??","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"lEI1GMbFoh"}],"key":"OfBCCCqUW5"}],"key":"jgtFoNRw3v"},{"type":"tableRow","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"ESA","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"xU6aMbwuTA"}],"key":"hhs6mA5XrW"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Herschel*","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"HVHnhsSynY"}],"key":"TZaFK5jbkJ"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Some spectra","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"B4NDABsLfn"}],"key":"xd00gxR2WH"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"astroquery.esa.hsa","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"kUKGQ145UW"}],"key":"w3g6evgBRI"},{"type":"tableCell","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"implemented with ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"rfwsvo9Gob"},{"type":"link","url":"https://astroquery.readthedocs.io/en/latest/esa/hsa/hsa.html","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"astroquery","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"nx08TPeaK8"}],"urlSource":"https://astroquery.readthedocs.io/en/latest/esa/hsa/hsa.html","key":"YkYTJTDCgZ"}],"key":"z4yCEfFBjq"}],"key":"KPzmTviZFt"},{"type":"tableRow","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"mr9g3fg0PI"}],"key":"A3BG0SuV5O"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Euclid","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"qlDkgLrXej"}],"key":"DkYBuFv9aG"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Spectra hosted at IRSA in FY25","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"kePZs4pdy4"}],"key":"v4XlMk7MqQ"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[],"key":"rBxFlGGUhl"},{"type":"tableCell","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Using Q1 Spectra in the red grism (RGS) ingested in FY25, to be updated to DR1","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"jaAh0FHhb8"}],"key":"ULBTw6V4c6"}],"key":"WfSxhKQMXA"},{"type":"tableRow","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"IRSA","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"k85U8JnlkT"}],"key":"rraXc7XlhX"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"SPHEREx","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"uzmkWH6c3J"}],"key":"nTbj1rjYqk"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Spectra/cubes will be hosted at IRSA, first release in FY25 -> preparation for ingestion","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"yEp0EuNbY7"}],"key":"qLMeSZIFV3"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[],"key":"EY3umMEItR"},{"type":"tableCell","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Will use mock spectra with correct format for testing","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"yq4dKXOOVH"}],"key":"kSXQVBivOM"}],"key":"QA8Tah7vlr"},{"type":"tableRow","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"MAST","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"GqhXlwbZki"}],"key":"Kr9R05lImY"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"HST*","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"cpC2C9KrHP"}],"key":"bAgqk1Zxyl"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Slitless spectra would need reduction and extraction. There are some reduced slit spectra from COS in the Hubble Archive","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Yye5Ye2dfi"}],"key":"L4xczeSbET"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"xWOeOFJFcg"}],"key":"C8ImAh1exT"},{"type":"tableCell","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Implemented using ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"HIXPHTcc9R"},{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"FoCiOjpfR8"}],"key":"jrKZupXKPz"}],"key":"loJfk0Q5Di"},{"type":"tableRow","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"MAST","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Rr7tsSR58G"}],"key":"C3W9ZgXPDM"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"JWST*","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"HItN42sbWu"}],"key":"KdPMBl8rOM"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Reduced slit MSA and Slit spectra that can be queried","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"rNZmo3lGqd"}],"key":"wlcfGiqaoq"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Mv6b1m0pVB"}],"key":"WjdUiFNJVy"},{"type":"tableCell","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Implemented using ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"cINGuVk3Zv"},{"type":"inlineCode","value":"astroquery.mast","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Yt3VOUPfnc"}],"key":"G3vjLDL1IR"}],"key":"Bn9OMSemYo"},{"type":"tableRow","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"SDSS","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"Skzdeo6u4q"}],"key":"GK3nfJW45y"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"SDSS optical","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"nhg2UiucXZ"}],"key":"EwkH7eNsJd"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Optical spectra that are reduced","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"oNA8ROAXZU"}],"key":"wT5THkMHvq"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"link","url":"https://skyserver.sdss.org/dr18/SearchTools","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Sky Server","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"DkUQyMAaMm"}],"urlSource":"https://skyserver.sdss.org/dr18/SearchTools","key":"cobkezYcOm"},{"type":"text","value":" or ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"NSfdNysWY7"},{"type":"inlineCode","value":"astroquery.sdss","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"bTgJ48WhwN"},{"type":"text","value":" (preferred)","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"TtpVqN96XQ"}],"key":"ieHpfOwPyz"},{"type":"tableCell","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Implemented using ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"dPrqadqdmz"},{"type":"inlineCode","value":"astroquery.sdss","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"GfeJt60NBJ"},{"type":"text","value":".","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"Gj5yCz5yAA"}],"key":"L3jCvrdDj6"}],"key":"YJeZW69QAw"},{"type":"tableRow","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"DESI","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"xpTIA14wFz"}],"key":"fNpzSOJ3vz"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"DESI*","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"XXnXwSt9lP"}],"key":"wgQ6JTqyil"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Optical spectra","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"DzBelqIw4X"}],"key":"NMMcx4Rz3C"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"link","url":"https://data.desi.lbl.gov/public/","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"DESI public data release","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"xeSo5AaSFR"}],"urlSource":"https://data.desi.lbl.gov/public/","key":"cdLkanqFOp"}],"key":"Wo0Nhkj0py"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"VBdjozeJRE"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"t8waBVG3cz"},{"type":"text","value":" library.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Sjb5EEEXu4"}],"key":"yHH9O861uS"}],"key":"wukaiRMoSv"},{"type":"tableRow","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"BOSS","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"YXTCvKOREa"}],"key":"LHgpcbKZbG"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"BOSS*","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"zP75RRfo8D"}],"key":"wOC0LlzJqK"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Optical spectra","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"DUKpEhV8Ep"}],"key":"RRBaOILctD"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"link","url":"https://www.sdss4.org/surveys/boss/","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"BOSS webpage (part of SDSS)","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Dit6H7yGAD"}],"urlSource":"https://www.sdss4.org/surveys/boss/","key":"zRPWj4kc4M"}],"key":"tPgT7Hu3LI"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Implemented with ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Qgt5Oi1Jcn"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"x50Wn3cKoH"},{"type":"text","value":" library together with DESI","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"oPK1UOl7gE"}],"key":"MBlzC6N2uH"}],"key":"uOQv4mfexG"},{"type":"tableRow","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"HEASARC","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"c8Qmbn3AVp"}],"key":"ElaZCYZZMH"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"None","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"CL4Y6RPTO4"}],"key":"HXXv9GOEoN"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Could link to Chandra observations to check AGN occurrence.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"eKMvkqOn6A"}],"key":"L7jT62mK7H"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"inlineCode","value":"astroquery.heasarc","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"bYftUFFLxM"}],"key":"NAyok8PwE3"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"More thoughts on how to include scientifically.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ZRR0MOE6jA"}],"key":"HVFej6FnGY"}],"key":"rIvbIv91tz"}],"key":"eWmHsstC11"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"The ones with an asterisk (*) are the challenging ones.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"UR4kgpFcmy"}],"key":"NcnBksE0AE"},{"type":"heading","depth":3,"position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Input","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"yQGC2zH1T2"}],"identifier":"input","label":"Input","html_id":"input","implicit":true,"key":"jVk7Hs2aSe"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"• Coordinates for a single source or a sample on the COSMOS field","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"QAD351SQdU"}],"key":"DhTNVQxutS"},{"type":"heading","depth":3,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Output","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"i33DYfzg77"}],"identifier":"output","label":"Output","html_id":"output","implicit":true,"key":"UjkXjG7hE5"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"• A Pandas data frame including the spectra from different facilities","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"wLKUfHP8W8"}],"key":"V9ejlHIuOx"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"• A plot comparing the different spectra extracted for each source","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"jT92yOsqiA"}],"key":"cNVNbYVSlZ"},{"type":"heading","depth":3,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Runtime","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"P7OkMP0GwT"}],"identifier":"runtime","label":"Runtime","html_id":"runtime","implicit":true,"key":"laVthWGSak"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"As of 2025 July, this notebook takes about 18 minutes to run to completion on Fornax using\na server with 16GB RAM/4 CPU’ and Environment: ‘Default Astrophysics’ (image).","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"gQesXEskKq"}],"key":"oj6PUQVb9M"}],"key":"rVHhnpAPQQ"},{"type":"block","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Datasets that were considered but didn’t end up being used","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"zIXCtpsUpn"}],"identifier":"datasets-that-were-considered-but-didnt-end-up-being-used","label":"Datasets that were considered but didn’t end up being used","html_id":"datasets-that-were-considered-but-didnt-end-up-being-used","implicit":true,"key":"cueSDbjgu5"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"IRTF:","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"lXVDzCODgH"}],"key":"pWp6YpF3dh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://irsa.ipac.caltech.edu/Missions/irtf.html","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"https://​irsa​.ipac​.caltech​.edu​/Missions​/irtf​.html","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"gC8l7TYPSK"}],"urlSource":"https://irsa.ipac.caltech.edu/Missions/irtf.html","key":"X7tKa2WoUS"}],"key":"icHhLWkdpS"}],"key":"PW9EUzijk0"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The IRTF is a 3.2 meter telescope, optimized for infrared observations, and located at the summit\nof Mauna Kea, Hawaiʻi.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"F1N5Qj8kmZ"}],"key":"s7HNmGaB9P"}],"key":"bEmMUMGOcc"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"large library of stellar spectra","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"qA4V9Io9Zr"}],"key":"ucMJrW8L58"}],"key":"tJCvQE9RtY"},{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Not included here because the data are not currently available in an easily accessible,\nsearchable format","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"B2wIXNXu9k"}],"key":"DftkPeWD8e"}],"key":"OgNzbRlq4F"}],"key":"U08cbWrGfE"},{"type":"heading","depth":2,"position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"rz9uUjvS2e"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"mZHL77VcM4"},{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"This cell will install them if needed:","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"Rsl1qa0ze5"}],"key":"eY4Lx2Yvp5"}],"key":"f70H8zOhV9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# %pip install -r requirements_spectra_collector.txt","key":"wRu2qI9AEA"},{"type":"outputs","id":"yn2rttqz7v30160NhkURR","children":[],"key":"twBU3jqz7O"}],"key":"R4LbtkwoQc"},{"type":"block","children":[],"key":"R74uV8yRGx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport sys\n\nimport astropy.units as u\nfrom astropy.coordinates import SkyCoord\nfrom astropy.table import Table\nfrom astropy.utils.data import conf\n\nsys.path.append('code_src/')\nfrom data_structures_spec import MultiIndexDFObject\nfrom desi_functions import DESIBOSS_get_spec\nfrom herschel_functions import Herschel_get_spec\nfrom keck_functions import KeckDEIMOS_get_spec\nfrom mast_functions import HST_get_spec, JWST_get_spec\nfrom plot_functions import create_figures\nfrom sample_selection import clean_sample\nfrom sdss_functions import SDSS_get_spec\nfrom spitzer_functions import SpitzerIRS_get_spec\nfrom euclid_functions import euclid_get_spec\n\n# The Euclid spectrum files are large and the time it takes to read\n# them can exceed astropy's default timeout limit. Increase it.\nconf.remote_timeout = 120","key":"kNlAVBJtwN"},{"type":"outputs","id":"5ofIsJ3IFgQ13n34gsUmj","children":[],"key":"rBzyAgHn6c"}],"key":"V5ygXu0F1i"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"1. Define the sample","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"m5a0tHUguA"}],"identifier":"id-1-define-the-sample","label":"1. Define the sample","html_id":"id-1-define-the-sample","implicit":true,"key":"JGEzVPb1JH"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Here we will define the sample of galaxies. For now, we just enter some “random” coordinates to\ntest the code.","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"ulUP4H5FP4"}],"key":"s0kAE8XcJo"}],"key":"kNKIw73N1Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coords = []\nlabels = []\n\ncoords.append(SkyCoord(\"{} {}\".format(\"09 54 49.40\", \"+09 16 15.9\"), unit=(u.hourangle, u.deg)))\nlabels.append(\"NGC3049\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"12 45 17.44 \", \"27 07 31.8\"), unit=(u.hourangle, u.deg)))\nlabels.append(\"NGC4670\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"14 01 19.92\", \"−33 04 10.7\"), unit=(u.hourangle, u.deg)))\nlabels.append(\"Tol_89\")\n\ncoords.append(SkyCoord(233.73856, 23.50321, unit=u.deg))\nlabels.append(\"Arp220\")\n\ncoords.append(SkyCoord(150.091, 2.2745833, unit=u.deg))\nlabels.append(\"COSMOS1\")\n\ncoords.append(SkyCoord(150.1024475, 2.2815559, unit=u.deg))\nlabels.append(\"COSMOS2\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"150.000\", \"+2.00\"), unit=(u.deg, u.deg)))\nlabels.append(\"COSMOS3\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"+53.15508\", \"-27.80178\"), unit=(u.deg, u.deg)))\nlabels.append(\"JADESGS-z7-01-QU\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"+53.15398\", \"-27.80095\"), unit=(u.deg, u.deg)))\nlabels.append(\"TestJWST\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"268.48058743\", \"64.78064676\"), unit=(u.deg, u.deg)))\nlabels.append(\"TestEuclid\")\n\ncoords.append(SkyCoord(\"{} {}\".format(\"+150.33622\", \"+55.89878\"), unit=(u.deg, u.deg)))\nlabels.append(\"Twin Quasar\")\n\nsample_table = clean_sample(coords, labels, precision=2.0 * u.arcsecond, verbose=1)","key":"EFdzRnxRb1"},{"type":"outputs","id":"sjR8FJNS9CLpmuAjr8e5z","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"after duplicates removal, sample size: 11\n"},"key":"xY76ZFxCAm"}],"key":"R0ohFR5XEC"}],"key":"kPO62qYc9d"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"1.2 Write out your sample to disk","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"rhSY8ADgAJ"}],"identifier":"id-1-2-write-out-your-sample-to-disk","label":"1.2 Write out your sample to disk","html_id":"id-1-2-write-out-your-sample-to-disk","implicit":true,"key":"sglGGE6CGj"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"At this point you may wish to write out your sample to disk and reuse that in future work sessions,\ninstead of creating it from scratch again. Note that we first check if the ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"CpWjqz1cdl"},{"type":"inlineCode","value":"data","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"sgJSvy3yms"},{"type":"text","value":" directory exists\nand if not, we will create one.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"gHz4XSkBxo"}],"key":"jtQyXys4X4"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"For the format of the save file, we would suggest to choose from various formats that fully support\nastropy objects(eg., SkyCoord).  One example that works is Enhanced Character-Separated Values or\n","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"q45TDqMcGz"},{"type":"link","url":"https://docs.astropy.org/en/stable/io/ascii/ecsv.html","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"‘ecsv’","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"qQNq9j70AE"}],"urlSource":"https://docs.astropy.org/en/stable/io/ascii/ecsv.html","key":"FHucN4vZZs"}],"key":"TbvGAYAd9t"}],"key":"JVGwW6MvKk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if not os.path.exists(\"./data\"):\n    os.mkdir(\"./data\")\nsample_table.write('data/input_sample.ecsv', format='ascii.ecsv', overwrite=True)","key":"Bea4zWzyYK"},{"type":"outputs","id":"rA60Nm9-pOXCGEOGq6Ya4","children":[],"key":"OQePEprq5U"}],"key":"OoxhSHWSVG"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"1.3 Load the sample table from disk","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"L5fisiJPfj"}],"identifier":"id-1-3-load-the-sample-table-from-disk","label":"1.3 Load the sample table from disk","html_id":"id-1-3-load-the-sample-table-from-disk","implicit":true,"key":"Ng1F0YFs6B"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Do only this step from this section when you have a previously generated sample table","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"aopwqTEDTP"}],"key":"tC5iQaTvl7"}],"key":"zuq3lF2eWo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sample_table = Table.read('data/input_sample.ecsv', format='ascii.ecsv')","key":"TdqKA3e8cV"},{"type":"outputs","id":"yRInV8ZKjUm3rhcKp3w80","children":[],"key":"Y2Ooo34Bvj"}],"key":"MYqBWRlaKh"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"1.4 Initialize data structure to hold the spectra","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"WVpz5YTjv6"}],"identifier":"id-1-4-initialize-data-structure-to-hold-the-spectra","label":"1.4 Initialize data structure to hold the spectra","html_id":"id-1-4-initialize-data-structure-to-hold-the-spectra","implicit":true,"key":"V7F3yoFRI8"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Here, we initialize the MultiIndex data structure that will hold the spectra.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"NVyajaJwJ5"}],"key":"GjG8k2V3EW"}],"key":"e9rVsWA6FM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_spec = MultiIndexDFObject()","key":"g9uL35RrCR"},{"type":"outputs","id":"i2aGFGTOWARecOWh1Rg3R","children":[],"key":"pnrsJSiuCL"}],"key":"SEbmoZHAIH"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"2. Find spectra for these targets in NASA and other ancillary catalogs","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"EZVD6NP4qe"}],"identifier":"id-2-find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs","label":"2. Find spectra for these targets in NASA and other ancillary catalogs","html_id":"id-2-find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs","implicit":true,"key":"p4iRlTbB1q"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"We search a curated list of NASA astrophysics archives.  Because each archive is different, and in\nmany cases each catalog is different, each function to access a catalog is necesarily specialized\nto the location and format of that particular catalog.","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"gYhk798enI"}],"key":"F52Cc2FViM"}],"key":"cEmeJdUuJ3"},{"type":"block","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"2.1 IRSA Archive","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"cr3aVp7LsU"}],"identifier":"id-2-1-irsa-archive","label":"2.1 IRSA Archive","html_id":"id-2-1-irsa-archive","implicit":true,"key":"OS7zIW3il1"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"This archive includes spectra taken by","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"atgfzuCMp0"}],"key":"a0lud3JBoG"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"• Keck","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"krlwe7fyEQ"}],"key":"J8QTdBiQcb"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"• Spitzer/IRS","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"VJIfd797kR"}],"key":"mjRbwPW9rB"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"• Euclid/NISP","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"f84nlWhck9"}],"key":"liqWadeUNz"}],"key":"edFH1bbbYb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get Keck Spectra (COSMOS only)\ndf_spec_DEIMOS = KeckDEIMOS_get_spec(sample_table=sample_table, search_radius_arcsec=1)\ndf_spec.append(df_spec_DEIMOS)","key":"fw4PnrBTIN"},{"type":"outputs","id":"Tqz5QwhYt9-rQy52w1Tmx","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"S23dFW4f5s"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"nk93enUxRA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"D7pSLInaAS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"yPZsRdWFBZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 1\nno calibration is available\n"},"key":"gMAQvQAFDB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 1\n"},"key":"t0I5B7kjdJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"pxUlwxy0iJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"ZTQCgsmUCV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"EAXmrmRhUK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"VYA9NIqjfR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"oqeJyoztWa"}],"key":"OGpj6mFdSE"}],"key":"JLs7sr9Zs7"},{"type":"block","children":[],"key":"f8ujLtftcz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get Spitzer IRS Spectra\ndf_spec_IRS = SpitzerIRS_get_spec(sample_table, search_radius_arcsec=1, COMBINESPEC=False)\ndf_spec.append(df_spec_IRS)","key":"xAxAElnCrG"},{"type":"outputs","id":"yy5plviv_6lhWvBp6T-Pq","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source NGC3049\n"},"key":"eQ3IkiquHP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source NGC4670\n"},"key":"YiZwohkf5w"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source Tol_89\n"},"key":"v4vTwaoz1l"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source Arp220\n"},"key":"StbydWnftb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 8\nMore than 1 entry found - pick the closest\n"},"key":"a0uTNG8KA1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source COSMOS1\n"},"key":"MSwZRzvgO3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source COSMOS2\n"},"key":"x8oNEWtlzs"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source COSMOS3\n"},"key":"aHe5AWYyQx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source JADESGS-z7-01-QU\n"},"key":"fuo6i1tXqK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source TestJWST\n"},"key":"cROgTNpp8c"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source TestEuclid\n"},"key":"oeRU8jXhUo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\nProcessing source Twin Quasar\n"},"key":"RbsQ23Cos6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of entries found: 0\n"},"key":"RPWhvX3eFd"}],"key":"ykPv2GAnAT"}],"key":"Ugz3keE07N"},{"type":"block","children":[],"key":"VyQxbzCPAA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get Euclid Spectra\ndf_spec_Euclid = euclid_get_spec(sample_table=sample_table, search_radius_arcsec=1)\ndf_spec.append(df_spec_Euclid)","key":"PgfiYA223D"},{"type":"outputs","id":"hMNd_jBHG1JhzDaLr6Xty","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for NGC3049 within 1.0 arcsec.\n"},"key":"g7qgWe2nxF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for NGC4670 within 1.0 arcsec.\n"},"key":"fskZf8c3BR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for Tol_89 within 1.0 arcsec.\n"},"key":"ks2dSq8MAk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for Arp220 within 1.0 arcsec.\n"},"key":"YQ3toDQvGY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for COSMOS1 within 1.0 arcsec.\n"},"key":"KMxtBe8aVM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for COSMOS2 within 1.0 arcsec.\n"},"key":"ntzktcJuzW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for COSMOS3 within 1.0 arcsec.\n"},"key":"xlrJEngpsl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for JADESGS-z7-01-QU within 1.0 arcsec.\n"},"key":"oVCVVg5FlC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for TestJWST within 1.0 arcsec.\n"},"key":"w1lPjPrfKE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Found Euclid SSA spectra for TestEuclid\n"},"key":"UCQI30lIJj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"No Euclid SSA spectra found for Twin Quasar within 1.0 arcsec.\n"},"key":"zgqwjuEWsE"}],"key":"ksCQAmPyL3"}],"key":"Ji3fDjgoHl"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"2.2 MAST Archive","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"nwqWU9tlLm"}],"identifier":"id-2-2-mast-archive","label":"2.2 MAST Archive","html_id":"id-2-2-mast-archive","implicit":true,"key":"OS6C5PkV9E"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"This archive includes spectra taken by","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"O6DJL0c7Hd"}],"key":"GMbdtZcC8z"},{"type":"paragraph","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"• HST (including slit spectroscopy)","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"wnhAjVPU6M"}],"key":"qcSbn8oHGZ"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"• JWST (including MSA and slit spectroscopy)","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"sLzok2c6Vy"}],"key":"jzXfbkzNBR"}],"key":"ybDONcN08v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get Spectra for HST\ndf_spec_HST = HST_get_spec(\n    sample_table,\n    search_radius_arcsec=0.5,\n    datadir=\"./data/\",\n    verbose=False,\n    delete_downloaded_data=True\n)\ndf_spec.append(df_spec_HST)","key":"GjBjOYUSlf"},{"type":"outputs","id":"D26Z2h4slurl1pWUvAVh0","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source NGC3049\n"},"key":"IyWK10WyoG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 9\n"},"key":"ri4o9CNPg6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files to download: 4\n"},"key":"UdRvEssYh6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source NGC4670\n"},"key":"AMlYUN7t3H"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 6\n"},"key":"n4HEzDuLnp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files to download: 2\n"},"key":"A9j8nWuJtq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source Tol_89\n"},"key":"c4UapDANoR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 9\nNumber of files to download: 3\n"},"key":"ELZd4A33v9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source Arp220\n"},"key":"sjMNuuK8i1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Arp220 could not be found\nProcessing source COSMOS1\n"},"key":"cAzkYOExhB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 4\nNumber of files to download: 0\nNothing to download for source COSMOS1.\nProcessing source COSMOS2\n"},"key":"a6tk0d4YBk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 3\nNumber of files to download: 0\nNothing to download for source COSMOS2.\nProcessing source COSMOS3\n"},"key":"zJbH2CAZfz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 1\nNumber of files to download: 0\nNothing to download for source COSMOS3.\nProcessing source JADESGS-z7-01-QU\n"},"key":"YftLqkkFWW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 97\n"},"key":"gEPwuXHu99"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source JADESGS-z7-01-QU.\nProcessing source TestJWST\n"},"key":"hWxUq0g9Wm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 93\n"},"key":"Y7Da9sdT5A"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files to download: 0\nNothing to download for source TestJWST.\nProcessing source TestEuclid\n"},"key":"o5VXXSnGRo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource TestEuclid could not be found\nProcessing source Twin Quasar\n"},"key":"gfwOMPTUG8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 6\n"},"key":"THcM9vuBgV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files to download: 2\n"},"key":"TVOXXH6lQ6"}],"key":"Vsr28BM8Ry"}],"key":"UYVniIzPio"},{"type":"block","children":[],"key":"ciQGJpj5hR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get Spectra for JWST\ndf_jwst = JWST_get_spec(\n    sample_table,\n    search_radius_arcsec=0.5,\n    verbose=False,\n    max_spectra_per_source = 5\n)\ndf_spec.append(df_jwst)","key":"lYK96uC5sm"},{"type":"outputs","id":"lBDvTpoJhk274kBG8yQP-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Searching Spectra in the cloud... \nINFO: Using the S3 STScI public dataset [astroquery.mast.cloud]\nProcessing source NGC3049\n"},"key":"xEcfPvCoML"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource NGC3049 could not be found\nProcessing source NGC4670\n"},"key":"eNtHBNAp04"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource NGC4670 could not be found\nProcessing source Tol_89\n"},"key":"HSwHgK4fXg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Tol_89 could not be found\nProcessing source Arp220\n"},"key":"UFQwlzxUAP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Arp220 could not be found\nProcessing source COSMOS1\n"},"key":"v99tQKpBRl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource COSMOS1 could not be found\nProcessing source COSMOS2\n"},"key":"urIydJpj73"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 2\n"},"key":"lpaa9fqBUX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files found: 12\nLimiting to first 5 spectra for source COSMOS2.\n"},"key":"HAXWIiYBIf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source COSMOS3\n"},"key":"cNGspjEj9m"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource COSMOS3 could not be found\nProcessing source JADESGS-z7-01-QU\n"},"key":"CPI3X2p4iz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 18\n"},"key":"KGZqkPbEW5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files found: 612\nLimiting to first 5 spectra for source JADESGS-z7-01-QU.\n"},"key":"pLTPJL0EZS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source TestJWST\n"},"key":"mRxenZK6j2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 6\n"},"key":"XpXKHGCR3u"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of files found: 630\nLimiting to first 5 spectra for source TestJWST.\n"},"key":"XIo1WEza3K"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Processing source TestEuclid\n"},"key":"WVyKmfqSY1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource TestEuclid could not be found\nProcessing source Twin Quasar\n"},"key":"yWDPKcyvTN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Number of search results: 0\nSource Twin Quasar could not be found\ndone\nGrouping Spectra... \nGrouping object COSMOS2\nGrouping object JADESGS-z7-01-QU\nGrouping object TestJWST\ndone\n"},"key":"d4FwEX8K5l"}],"key":"dDcrTMCVul"}],"key":"o0X1SoWVbl"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"2.3 ESA Archive","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"EF1LjPdr1I"}],"identifier":"id-2-3-esa-archive","label":"2.3 ESA Archive","html_id":"id-2-3-esa-archive","implicit":true,"key":"gNPVM6SFLh"}],"key":"j5IJ9mPzA6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Herschel PACS & SPIRE from ESA TAP using astroquery\n# This search is fully functional, but is commented out because it takes\n# ~4 hours to run to completion\nherschel_radius = 1.1\nherschel_download_directory = 'data/herschel'\n\n# if not os.path.exists(herschel_download_directory):\n#    os.makedirs(herschel_download_directory, exist_ok=True)\n# df_spec_herschel =  Herschel_get_spec(sample_table, herschel_radius, herschel_download_directory, delete_downloaded_data=True)\n# df_spec.append(df_spec_herschel)","key":"AM4SGjVk0d"},{"type":"outputs","id":"JWeruuvI4ATJC36cNnxoc","children":[],"key":"xcHePA4bcG"}],"key":"bLEGB2lpjD"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"2.4 SDSS Archive","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"oUkNpjqyqT"}],"identifier":"id-2-4-sdss-archive","label":"2.4 SDSS Archive","html_id":"id-2-4-sdss-archive","implicit":true,"key":"tdQFkThqvR"}],"key":"zx9ZaHGF94"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get SDSS Spectra\ndf_spec_SDSS = SDSS_get_spec(sample_table, search_radius_arcsec=5, data_release=17)\ndf_spec.append(df_spec_SDSS)","key":"pFPgQmVyDN"},{"type":"outputs","id":"coDXvlAGQe2kVB5w86QKc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source Tol_89 could not be found in SDSS.\n  warnings.warn(\n"},"key":"v6V4CulhP4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source COSMOS1 could not be found in SDSS.\n  warnings.warn(\n/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source COSMOS2 could not be found in SDSS.\n  warnings.warn(\n/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source COSMOS3 could not be found in SDSS.\n  warnings.warn(\n/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source JADESGS-z7-01-QU could not be found in SDSS.\n  warnings.warn(\n/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source TestJWST could not be found in SDSS.\n  warnings.warn(\n/home/runner/work/fornax-demo-notebooks/fornax-demo-notebooks/spectroscopy/code_src/sdss_functions.py:53: RuntimeWarning: Source TestEuclid could not be found in SDSS.\n  warnings.warn(\n"},"key":"Jl8LbsNlKV"}],"key":"BUg2dnI2UE"}],"key":"jYHSqyVv6S"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"2.5 DESI Archive","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"Rk97ME9QED"}],"identifier":"id-2-5-desi-archive","label":"2.5 DESI Archive","html_id":"id-2-5-desi-archive","implicit":true,"key":"KU0u2oKt75"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"This includes DESI spectra. Here, we use the ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"SXJTnGoMil"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"ZzGvs5rZqX"},{"type":"text","value":" query. Note that this can also be used\nfor SDSS searches, however, according to the SPARCL webpage, only up to DR16 is included.\nTherefore, we will not include SDSS DR16 here (this is treated in the SDSS search above).","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"o8cRKjJAje"}],"key":"SLtVRnLizD"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"The DESI search is currently commented out because ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"oTCofVIeCU"},{"type":"inlineCode","value":"SPARCL","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"n3sorA5lvN"},{"type":"text","value":" is not compatible with numpy > 2 which we require for the other modules to run.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"ku3ZaWfuC5"}],"key":"JN8Rjl8Bre"}],"key":"BB6iTwMIAm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## Get DESI and BOSS spectra with SPARCL\ndf_spec_DESIBOSS = DESIBOSS_get_spec(sample_table, search_radius_arcsec=5)\ndf_spec.append(df_spec_DESIBOSS)","key":"qnkMJvnqMl"},{"type":"outputs","id":"A_bkVBIEaPdpzMjKMp98f","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"announcement=Data set deprecation notice: on November 19, 2025 the SDSS/BOSS DR16 data sets were deprecated. Please use the new SDSS/BOSS DR17 data sets instead.\n"},"key":"FAXZ0jziVg"}],"key":"mAbFhGQXKl"}],"key":"h9cfz2x3DZ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"3. Make plots of luminosity as a function of time","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"r8aG0RBYaS"}],"identifier":"id-3-make-plots-of-luminosity-as-a-function-of-time","label":"3. Make plots of luminosity as a function of time","html_id":"id-3-make-plots-of-luminosity-as-a-function-of-time","implicit":true,"key":"st2YSWq92q"},{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"We show flux in mJy as a function of time for all available bands for each object.\n","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"y3GfXP5cNc"},{"type":"inlineCode","value":"show_nbr_figures","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"bf7omqhEZj"},{"type":"text","value":" controls how many plots are actually generated and returned to the screen.\nIf you choose to save the plots with ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"EEx5BHarmq"},{"type":"inlineCode","value":"save_output","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"hQ5A90gqZa"},{"type":"text","value":", they will be put in the output directory and\nlabelled by sample number.","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"orkhGMd1Z5"}],"key":"T17fgPbMcf"}],"key":"sR8PcZFnpP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"### Plotting ####\ncreate_figures(df_spec=df_spec,\n               bin_factor=1,\n               show_nbr_figures=10,\n               save_output=False,\n               )","key":"Vapuw61cLj"},{"type":"outputs","id":"n7iDvWU33bcdMNrIv23Od","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"61406d24f4dd01b2f5da8854f178d692","path":"/fornax-demo-notebooks/build/61406d24f4dd01b2f5da8854f178d692.png"}}},"key":"tmVQLLzxgg"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e73426fcfadeee428231c6441fdb3079","path":"/fornax-demo-notebooks/build/e73426fcfadeee428231c6441fdb3079.png"}}},"key":"J3o5phQmIo"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5a3e0e20844e859d304b5e93775d27ca","path":"/fornax-demo-notebooks/build/5a3e0e20844e859d304b5e93775d27ca.png"}}},"key":"wmBOkXuFYS"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"abd31f590f290fe40aec514fcded9134","path":"/fornax-demo-notebooks/build/abd31f590f290fe40aec514fcded9134.png"}}},"key":"nWQhkIb3uU"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1368af13c4373fb2002b3b5dd295cde3","path":"/fornax-demo-notebooks/build/1368af13c4373fb2002b3b5dd295cde3.png"}}},"key":"qre7EtRtEx"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"561af1de15cb7bd8405ce30bc50e2fd9","path":"/fornax-demo-notebooks/build/561af1de15cb7bd8405ce30bc50e2fd9.png"}}},"key":"bllUTIUg5C"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f182b643a6f3308fca55c25a627a6a12","path":"/fornax-demo-notebooks/build/f182b643a6f3308fca55c25a627a6a12.png"}}},"key":"uecMMePO9t"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f5eb7912e1d5903444fe2649e6ee31f2","path":"/fornax-demo-notebooks/build/f5eb7912e1d5903444fe2649e6ee31f2.png"}}},"key":"wyndHCnXW2"}],"key":"CHKMxfCn0m"}],"key":"jQUhXXFSC8"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"About this notebook","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"U8xIj1VgvC"}],"identifier":"about-this-notebook","label":"About this notebook","html_id":"about-this-notebook","implicit":true,"key":"UTBXmsi3sd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":326,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"Authors:","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"MJe6quxheO"}],"key":"pdHEIUBDvn"},{"type":"text","value":" Andreas Faisst, Jessica Krick, Shoubaneh Hemmati, Troy Raen, Brigitta Sipőcz, David Shupe, and the Fornax team","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"UK20fo77pz"}],"key":"Ob6AZAkmLw"}],"key":"pxibwAg4Py"},{"type":"listItem","spread":true,"position":{"start":{"line":327,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"zcpJuWQAX4"}],"key":"eU1py6BNEa"},{"type":"text","value":" For help with this notebook, please open a topic in the ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"AbFYJf6jXC"},{"type":"link","url":"https://discourse.fornax.sciencecloud.nasa.gov/","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"Fornax Community Forum","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"KDDxZ1VqtM"}],"urlSource":"https://discourse.fornax.sciencecloud.nasa.gov/","key":"ggWQZr5t9T"},{"type":"text","value":" “Support” category.","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"vfWqVAP7KN"}],"key":"gCLqU4LobX"}],"key":"zbNg6Ci2AT"}],"key":"WLgn8UkMzB"},{"type":"heading","depth":3,"position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"Acknowledgements","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"vVVEOyMwTK"}],"identifier":"acknowledgements","label":"Acknowledgements","html_id":"acknowledgements","implicit":true,"key":"WmvaKLTCQb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"AI: This notebook was created with assistance from OpenAI’s ChatGPT o4-mini-high model.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"EWKghnbAGw"}],"key":"Cbd0xIWdyV"}],"key":"A4p59IkQNZ"}],"key":"GmayJGHWBa"}],"key":"P2KA5dHIVz"}],"key":"xWLNXnB8A1"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Spectroscopy","url":"/spectroscopy","group":"The Fornax Initiative"},"next":{"title":"Multi-band forced photometry","url":"/forced-photometry","group":"The Fornax Initiative"}}},"domain":"http://localhost:3000"}
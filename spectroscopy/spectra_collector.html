
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extract Multi-Wavelength Spectroscopy from Archival Data &#8212; Fornax Demo Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'spectroscopy/spectra_collector';</script>
    <link rel="icon" href="../_static/fornax_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cross Matching" href="../crossmatch/README.html" />
    <link rel="prev" title="Spectroscopy" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/fornax_logo.png" class="logo__image only-light" alt="Fornax Demo Notebooks - Home"/>
    <script>document.write(`<img src="../_static/fornax_logo.png" class="logo__image only-dark" alt="Fornax Demo Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/nasa-fornax/fornax-demo-notebooks" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    The Fornax Initiative
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../forced_photometry/README.html">Multi-band forced photometry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../forced_photometry/multiband_photometry.html">Automated Multiband Forced Photometry on Large Datasets</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../light_curves/README.html">Time Domain</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../light_curves/light_curve_collector.html">Make Multi-Wavelength Light Curves Using Archival Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../light_curves/scale_up.html">Make Multi-Wavelength Light Curves for Large Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../light_curves/light_curve_classifier.html">Light Curve Classifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../light_curves/ML_AGNzoo.html">AGN Zoo: Comparison of AGN selected with different metrics</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Spectroscopy</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Extract Multi-Wavelength Spectroscopy from Archival Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../crossmatch/README.html">Cross Matching</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../crossmatch/ztf_ps1_crossmatch.html">Cross-Match ZTF and Pan-STARRS using LSDB</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nasa-fornax/fornax-demo-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nasa-fornax/fornax-demo-notebooks/issues/new?title=Issue%20on%20page%20%2Fspectroscopy/spectra_collector.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/spectroscopy/spectra_collector.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Extract Multi-Wavelength Spectroscopy from Archival Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-of-spectroscopic-archives-and-status">List of Spectroscopic Archives and Status</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input">Input:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output">Output:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-standard-imports">Non-standard Imports:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime">Runtime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#authors">Authors:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-that-were-considered-but-didn-t-end-up-being-used">Datasets that were considered but didn’t end up being used:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#irtf">IRTF:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-sample">1. Define the sample</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-out-your-sample-to-disk">1.2 Write out your sample to disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-sample-table-from-disk">1.3 Load the sample table from disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-data-structure-to-hold-the-spectra">1.4 Initialize data structure to hold the spectra</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs">2. Find spectra for these targets in NASA and other ancillary catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irsa-archive">2.1 IRSA Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-archive">2.2 MAST Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esa-archive">2.3 ESA Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdss-archive">2.4 SDSS Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#desi-archive">2.5 DESI Archive</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-plots-of-luminosity-as-a-function-of-time">3. Make plots of luminosity as a function of time</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="extract-multi-wavelength-spectroscopy-from-archival-data">
<h1>Extract Multi-Wavelength Spectroscopy from Archival Data<a class="headerlink" href="#extract-multi-wavelength-spectroscopy-from-archival-data" title="Link to this heading">#</a></h1>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<p>By the end of this tutorial, you will be able to:</p>
<p>• automatically load a catalog of sources</p>
<p>• search NASA and non-NASA resources for fully reduced spectra and load them using specutils</p>
<p>• store the spectra in a Pandas multiindex dataframe</p>
<p>• plot all the spectra of a given source</p>
</section>
<section id="introduction">
<h2>Introduction:<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="motivation">
<h3>Motivation<a class="headerlink" href="#motivation" title="Link to this heading">#</a></h3>
<p>A user has a source (or a sample of sources) for which they want to obtain spectra covering ranges
of wavelengths from the UV to the far-IR. The large amount of spectra available enables
multi-wavelength spectroscopic studies, which is crucial to understand the physics of stars,
galaxies, and AGN. However, gathering and analysing spectra is a difficult endeavor as the spectra
are distributed over different archives and in addition they have different formats which
complicates their handling. This notebook showcases a tool for the user to conveniently query the
spectral archives and collect the spectra for a set of objects in a format that can be read in
using common software such as the Python <code class="docutils literal notranslate"><span class="pre">specutils</span></code> package. For simplicity, we limit the tool to
query already reduced and calibrated spectra.
The notebook may focus on the COSMOS field for now, which has a large overlap of spectroscopic
surveys such as with SDSS, DESI, Keck, HST, JWST, Spitzer, and Herschel. In addition, the tool
enables the capability to search and ingest spectra from Euclid and SPHEREx in the feature. For
this to work, the <code class="docutils literal notranslate"><span class="pre">specutils</span></code> functions may have to be update or a wrapper has to be implemented.</p>
</section>
<section id="list-of-spectroscopic-archives-and-status">
<h3>List of Spectroscopic Archives and Status<a class="headerlink" href="#list-of-spectroscopic-archives-and-status" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Archive</p></th>
<th class="head"><p>Spectra</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Access point</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IRSA</p></td>
<td><p>Keck</p></td>
<td><p>About 10,000 spectra on the COSMOS field from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJ...858...77H/abstract">Hasinger et al. (2018)</a></p></td>
<td><p><a class="reference external" href="https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-scan?projshort=COSMOS">IRSA Archive</a></p></td>
<td><p>Implemented with <code class="docutils literal notranslate"><span class="pre">astroquery.ipac.irsa</span></code>. (Table gives URLs to spectrum FITS files.) Note: only implemented for absolute calibrated spectra.</p></td>
</tr>
<tr class="row-odd"><td><p>IRSA</p></td>
<td><p>Spitzer IRS</p></td>
<td><p>~17,000 merged low-resolution IRS spectra</p></td>
<td><p><a class="reference external" href="https://irsa.ipac.caltech.edu/cgi-bin/Gator/nph-dd?catalog=irs_enhv211">IRS Enhanced Product</a></p></td>
<td><p>Implemented with <code class="docutils literal notranslate"><span class="pre">astroquery.ipac.irsa</span></code>. (Table gives URLs to spectrum IPAC tables.)</p></td>
</tr>
<tr class="row-even"><td><p>IRSA</p></td>
<td><p>IRTF*</p></td>
<td><p>Large library of stellar spectra</p></td>
<td><p></p></td>
<td><p>does <code class="docutils literal notranslate"><span class="pre">astroquery.ipac.irsa</span></code> work??</p></td>
</tr>
<tr class="row-odd"><td><p>ESA</p></td>
<td><p>Herschel*</p></td>
<td><p>Some spectra</p></td>
<td><p>astroquery.esa.hsa</p></td>
<td><p>implemented with <a class="reference external" href="https://astroquery.readthedocs.io/en/latest/esa/hsa/hsa.html">astroquery</a></p></td>
</tr>
<tr class="row-even"><td><p>IRSA</p></td>
<td><p>Euclid</p></td>
<td><p>Spectra hosted at IRSA in FY25</p></td>
<td><p></p></td>
<td><p>Using Q1 Spectra in the red grism (RGS) ingested in FY25, to be updated to DR1</p></td>
</tr>
<tr class="row-odd"><td><p>IRSA</p></td>
<td><p>SPHEREx</p></td>
<td><p>Spectra/cubes will be hosted at IRSA, first release in FY25 -&gt; preparation for ingestion</p></td>
<td><p></p></td>
<td><p>Will use mock spectra with correct format for testing</p></td>
</tr>
<tr class="row-even"><td><p>MAST</p></td>
<td><p>HST*</p></td>
<td><p>Slitless spectra would need reduction and extraction. There are some reduced slit spectra from COS in the Hubble Archive</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></td>
<td><p>Implemented using <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MAST</p></td>
<td><p>JWST*</p></td>
<td><p>Reduced slit MSA and Slit spectra that can be queried</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></td>
<td><p>Implemented using <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SDSS</p></td>
<td><p>SDSS optical</p></td>
<td><p>Optical spectra that are reduced</p></td>
<td><p><a class="reference external" href="https://skyserver.sdss.org/dr18/SearchTools">Sky Server</a> or <code class="docutils literal notranslate"><span class="pre">astroquery.sdss</span></code> (preferred)</p></td>
<td><p>Implemented using <code class="docutils literal notranslate"><span class="pre">astroquery.sdss</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>DESI</p></td>
<td><p>DESI*</p></td>
<td><p>Optical spectra</p></td>
<td><p><a class="reference external" href="https://data.desi.lbl.gov/public/">DESI public data release</a></p></td>
<td><p>Implemented with <code class="docutils literal notranslate"><span class="pre">SPARCL</span></code> library.  Currently commented out because <code class="docutils literal notranslate"><span class="pre">SPARCL</span></code> library is incompatible with numpy &gt; 2 which we need for other modules</p></td>
</tr>
<tr class="row-even"><td><p>BOSS</p></td>
<td><p>BOSS*</p></td>
<td><p>Optical spectra</p></td>
<td><p><a class="reference external" href="https://www.sdss4.org/surveys/boss/">BOSS webpage (part of SDSS)</a></p></td>
<td><p>Implemented with <code class="docutils literal notranslate"><span class="pre">SPARCL</span></code> library together with DESI</p></td>
</tr>
<tr class="row-odd"><td><p>HEASARC</p></td>
<td><p>None</p></td>
<td><p>Could link to Chandra observations to check AGN occurrence.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">astroquery.heasarc</span></code></p></td>
<td><p>More thoughts on how to include scientifically.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The ones with an asterisk (*) are the challenging ones.</p>
</section>
</section>
<section id="input">
<h2>Input:<a class="headerlink" href="#input" title="Link to this heading">#</a></h2>
<p>• Coordinates for a single source or a sample on the COSMOS field</p>
</section>
<section id="output">
<h2>Output:<a class="headerlink" href="#output" title="Link to this heading">#</a></h2>
<p>• A Pandas data frame including the spectra from different facilities</p>
<p>• A plot comparing the different spectra extracted for each source</p>
</section>
<section id="non-standard-imports">
<h2>Non-standard Imports:<a class="headerlink" href="#non-standard-imports" title="Link to this heading">#</a></h2>
<p>• …</p>
</section>
<section id="runtime">
<h2>Runtime<a class="headerlink" href="#runtime" title="Link to this heading">#</a></h2>
<p>As of 2025 July, this notebook takes about 18 minutes to run to completion on Fornax using
a server with 16GB RAM/4 CPU’ and Environment: ‘Default Astrophysics’ (image).</p>
</section>
<section id="authors">
<h2>Authors:<a class="headerlink" href="#authors" title="Link to this heading">#</a></h2>
<p>Andreas Faisst, Jessica Krick, Shoubaneh Hemmati, Troy Raen, Brigitta Sipőcz, David Shupe</p>
</section>
<section id="acknowledgements">
<h2>Acknowledgements:<a class="headerlink" href="#acknowledgements" title="Link to this heading">#</a></h2>
<p>AI: This notebook was created with assistance from OpenAI’s ChatGPT o4-mini-high model.</p>
<section id="datasets-that-were-considered-but-didn-t-end-up-being-used">
<h3>Datasets that were considered but didn’t end up being used:<a class="headerlink" href="#datasets-that-were-considered-but-didn-t-end-up-being-used" title="Link to this heading">#</a></h3>
<section id="irtf">
<h4>IRTF:<a class="headerlink" href="#irtf" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>https://irsa.ipac.caltech.edu/Missions/irtf.html</p></li>
<li><p>The IRTF is a 3.2 meter telescope, optimized for infrared observations, and located at the summit
of Mauna Kea, Hawaiʻi.</p></li>
<li><p>large library of stellar spectra</p></li>
<li><p>Not included here because the data are not currently available in an easily accessible,
searchable format</p></li>
</ul>
</section>
</section>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p>This cell will install them if needed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment the next line to install dependencies if needed.</span>
<span class="c1"># %pip install -r requirements_spectra_collector.txt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;code_src/&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">data_structures_spec</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiIndexDFObject</span>
<span class="c1">#from desi_functions import DESIBOSS_get_spec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">herschel_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Herschel_get_spec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keck_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeckDEIMOS_get_spec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mast_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">HST_get_spec</span><span class="p">,</span> <span class="n">JWST_get_spec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plot_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_figures</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sample_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">clean_sample</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sdss_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">SDSS_get_spec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spitzer_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpitzerIRS_get_spec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">euclid_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">euclid_get_spec</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-sample">
<h2>1. Define the sample<a class="headerlink" href="#define-the-sample" title="Link to this heading">#</a></h2>
<p>Here we will define the sample of galaxies. For now, we just enter some “random” coordinates to
test the code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;09 54 49.40&quot;</span><span class="p">,</span> <span class="s2">&quot;+09 16 15.9&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NGC3049&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;12 45 17.44 &quot;</span><span class="p">,</span> <span class="s2">&quot;27 07 31.8&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NGC4670&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;14 01 19.92&quot;</span><span class="p">,</span> <span class="s2">&quot;−33 04 10.7&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Tol_89&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="mf">233.73856</span><span class="p">,</span> <span class="mf">23.50321</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Arp220&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="mf">150.091</span><span class="p">,</span> <span class="mf">2.2745833</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;COSMOS1&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="mf">150.1024475</span><span class="p">,</span> <span class="mf">2.2815559</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;COSMOS2&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;150.000&quot;</span><span class="p">,</span> <span class="s2">&quot;+2.00&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;COSMOS3&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;+53.15508&quot;</span><span class="p">,</span> <span class="s2">&quot;-27.80178&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;JADESGS-z7-01-QU&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;+53.15398&quot;</span><span class="p">,</span> <span class="s2">&quot;-27.80095&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TestJWST&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;268.48058743&quot;</span><span class="p">,</span> <span class="s2">&quot;64.78064676&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TestEuclid&quot;</span><span class="p">)</span>

<span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;+150.33622&quot;</span><span class="p">,</span> <span class="s2">&quot;+55.89878&quot;</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Twin Quasar&quot;</span><span class="p">)</span>

<span class="n">sample_table</span> <span class="o">=</span> <span class="n">clean_sample</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsecond</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>after duplicates removal, sample size: 11
</pre></div>
</div>
</div>
</div>
<section id="write-out-your-sample-to-disk">
<h3>1.2 Write out your sample to disk<a class="headerlink" href="#write-out-your-sample-to-disk" title="Link to this heading">#</a></h3>
<p>At this point you may wish to write out your sample to disk and reuse that in future work sessions,
instead of creating it from scratch again. Note that we first check if the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory exists
and if not, we will create one.</p>
<p>For the format of the save file, we would suggest to choose from various formats that fully support
astropy objects(eg., SkyCoord).  One example that works is Enhanced Character-Separated Values or
<a class="reference external" href="https://docs.astropy.org/en/stable/io/ascii/ecsv.html">‘ecsv’</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./data&quot;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./data&quot;</span><span class="p">)</span>
<span class="n">sample_table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;data/input_sample.ecsv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ecsv&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-sample-table-from-disk">
<h3>1.3 Load the sample table from disk<a class="headerlink" href="#load-the-sample-table-from-disk" title="Link to this heading">#</a></h3>
<p>Do only this step from this section when you have a previously generated sample table</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data/input_sample.ecsv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ecsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize-data-structure-to-hold-the-spectra">
<h3>1.4 Initialize data structure to hold the spectra<a class="headerlink" href="#initialize-data-structure-to-hold-the-spectra" title="Link to this heading">#</a></h3>
<p>Here, we initialize the MultiIndex data structure that will hold the spectra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_spec</span> <span class="o">=</span> <span class="n">MultiIndexDFObject</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs">
<h2>2. Find spectra for these targets in NASA and other ancillary catalogs<a class="headerlink" href="#find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs" title="Link to this heading">#</a></h2>
<p>We search a curated list of NASA astrophysics archives.  Because each archive is different, and in
many cases each catalog is different, each function to access a catalog is necesarily specialized
to the location and format of that particular catalog.</p>
<section id="irsa-archive">
<h3>2.1 IRSA Archive<a class="headerlink" href="#irsa-archive" title="Link to this heading">#</a></h3>
<p>This archive includes spectra taken by</p>
<p>• Keck</p>
<p>• Spitzer/IRS</p>
<p>• Euclid/NISP</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Get Keck Spectra (COSMOS only)</span>
<span class="n">df_spec_DEIMOS</span> <span class="o">=</span> <span class="n">KeckDEIMOS_get_spec</span><span class="p">(</span><span class="n">sample_table</span><span class="o">=</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">search_radius_arcsec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_spec_DEIMOS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of entries found: 0
Number of entries found: 0
Number of entries found: 0
Number of entries found: 0
Number of entries found: 1
no calibration is available
Number of entries found: 1
Number of entries found: 0
Number of entries found: 0
Number of entries found: 0
Number of entries found: 0
Number of entries found: 0
CPU times: user 270 ms, sys: 15 ms, total: 285 ms
Wall time: 34.1 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Get Spitzer IRS Spectra</span>
<span class="n">df_spec_IRS</span> <span class="o">=</span> <span class="n">SpitzerIRS_get_spec</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">search_radius_arcsec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">COMBINESPEC</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_spec_IRS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing source NGC3049
Number of entries found: 0
Processing source NGC4670
Number of entries found: 0
Processing source Tol_89
Number of entries found: 0
Processing source Arp220
Number of entries found: 8
More than 1 entry found - pick the closest
Processing source COSMOS1
Number of entries found: 0
Processing source COSMOS2
Number of entries found: 0
Processing source COSMOS3
Number of entries found: 0
Processing source JADESGS-z7-01-QU
Number of entries found: 0
Processing source TestJWST
Number of entries found: 0
Processing source TestEuclid
Number of entries found: 0
Processing source Twin Quasar
Number of entries found: 0
CPU times: user 224 ms, sys: 4.57 ms, total: 228 ms
Wall time: 30.6 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Get Euclid Spectra</span>
<span class="n">df_spec_Euclid</span> <span class="o">=</span> <span class="n">euclid_get_spec</span><span class="p">(</span><span class="n">sample_table</span><span class="o">=</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">search_radius_arcsec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_spec_Euclid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing source NGC3049
No match found in Euclid MER catalog for NGC3049.
Processing source NGC4670
No match found in Euclid MER catalog for NGC4670.
Processing source Tol_89
No match found in Euclid MER catalog for Tol_89.
Processing source Arp220
No match found in Euclid MER catalog for Arp220.
Processing source COSMOS1
No match found in Euclid MER catalog for COSMOS1.
Processing source COSMOS2
No match found in Euclid MER catalog for COSMOS2.
Processing source COSMOS3
No match found in Euclid MER catalog for COSMOS3.
Processing source JADESGS-z7-01-QU
No match found in Euclid MER catalog for JADESGS-z7-01-QU.
Processing source TestJWST
No match found in Euclid MER catalog for TestJWST.
Processing source TestEuclid
Found Euclid object_id: 2684805874647806467
Processing source Twin Quasar
No match found in Euclid MER catalog for Twin Quasar.
CPU times: user 4.03 s, sys: 326 ms, total: 4.36 s
Wall time: 53.9 s
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-archive">
<h3>2.2 MAST Archive<a class="headerlink" href="#mast-archive" title="Link to this heading">#</a></h3>
<p>This archive includes spectra taken by</p>
<p>• HST (including slit spectroscopy)</p>
<p>• JWST (including MSA and slit spectroscopy)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Get Spectra for HST</span>
<span class="n">df_spec_HST</span> <span class="o">=</span> <span class="n">HST_get_spec</span><span class="p">(</span>
    <span class="n">sample_table</span><span class="p">,</span>
    <span class="n">search_radius_arcsec</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">datadir</span><span class="o">=</span><span class="s2">&quot;./data/&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">delete_downloaded_data</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">df_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_spec_HST</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing source NGC3049
Number of search results: 8
Number of files to download: 4
Processing source NGC4670
Number of search results: 5
Number of files to download: 2
Processing source Tol_89
Number of search results: 8
Number of files to download: 3
Processing source Arp220
Number of search results: 0
Source Arp220 could not be found
Processing source COSMOS1
Number of search results: 4
Number of files to download: 0
Nothing to download for source COSMOS1.
Processing source COSMOS2
Number of search results: 3
Number of files to download: 0
Nothing to download for source COSMOS2.
Processing source COSMOS3
Number of search results: 1
Number of files to download: 0
Nothing to download for source COSMOS3.
Processing source JADESGS-z7-01-QU
Number of search results: 97
Number of files to download: 0
Nothing to download for source JADESGS-z7-01-QU.
Processing source TestJWST
Number of search results: 93
Number of files to download: 0
Nothing to download for source TestJWST.
Processing source TestEuclid
Number of search results: 0
Source TestEuclid could not be found
Processing source Twin Quasar
Number of search results: 5
Number of files to download: 2
CPU times: user 1.59 s, sys: 50.6 ms, total: 1.64 s
Wall time: 3min
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Get Spectra for JWST</span>
<span class="n">df_jwst</span> <span class="o">=</span> <span class="n">JWST_get_spec</span><span class="p">(</span>
    <span class="n">sample_table</span><span class="p">,</span>
    <span class="n">search_radius_arcsec</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">max_spectra_per_source</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">)</span>
<span class="n">df_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_jwst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Searching Spectra in the cloud... 
INFO: Using the S3 STScI public dataset [astroquery.mast.cloud]
Processing source NGC3049
Number of search results: 0
Source NGC3049 could not be found
Processing source NGC4670
Number of search results: 0
Source NGC4670 could not be found
Processing source Tol_89
Number of search results: 0
Source Tol_89 could not be found
Processing source Arp220
Number of search results: 0
Source Arp220 could not be found
Processing source COSMOS1
Number of search results: 0
Source COSMOS1 could not be found
Processing source COSMOS2
Number of search results: 2
Number of files found: 12
Limiting to first 5 spectra for source COSMOS2.
Skipping jw02565001001_03101_00003_nrs1_x1d.fits: not available in cloud.
Skipping jw02565001001_03101_00002_nrs1_x1d.fits: not available in cloud.
Processing source COSMOS3
Number of search results: 0
Source COSMOS3 could not be found
Processing source JADESGS-z7-01-QU
Number of search results: 112
Number of files found: 2304
Limiting to first 5 spectra for source JADESGS-z7-01-QU.
Processing source TestJWST
Number of search results: 102
Number of files found: 2358
Limiting to first 5 spectra for source TestJWST.
Processing source TestEuclid
Number of search results: 0
Source TestEuclid could not be found
Processing source Twin Quasar
Number of search results: 0
Source Twin Quasar could not be found
done
Grouping Spectra... 
Grouping object COSMOS2
Grouping object JADESGS-z7-01-QU
Grouping object TestJWST
done
CPU times: user 26.4 s, sys: 2.05 s, total: 28.5 s
Wall time: 12min 2s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: NoResultsWarning: Unable to locate file jwst/public/jw02565/jw02565001001/jw02565001001_03101_00003_nrs1_x1d.fits. [astroquery.mast.cloud]
WARNING: NoResultsWarning: Unable to locate file jwst/public/jw02565/jw02565001001/jw02565001001_03101_00002_nrs1_x1d.fits. [astroquery.mast.cloud]
</pre></div>
</div>
</div>
</div>
</section>
<section id="esa-archive">
<h3>2.3 ESA Archive<a class="headerlink" href="#esa-archive" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Herschel PACS &amp; SPIRE from ESA TAP using astroquery</span>
<span class="c1"># This search is fully functional, but is commented out because it takes</span>
<span class="c1"># ~4 hours to run to completion</span>
<span class="n">herschel_radius</span> <span class="o">=</span> <span class="mf">1.1</span>
<span class="n">herschel_download_directory</span> <span class="o">=</span> <span class="s1">&#39;data/herschel&#39;</span>

<span class="c1"># if not os.path.exists(herschel_download_directory):</span>
<span class="c1">#    os.makedirs(herschel_download_directory, exist_ok=True)</span>
<span class="c1"># df_spec_herschel =  Herschel_get_spec(sample_table, herschel_radius, herschel_download_directory, delete_downloaded_data=True)</span>
<span class="c1"># df_spec.append(df_spec_herschel)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sdss-archive">
<h3>2.4 SDSS Archive<a class="headerlink" href="#sdss-archive" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Get SDSS Spectra</span>
<span class="n">df_spec_SDSS</span> <span class="o">=</span> <span class="n">SDSS_get_spec</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">search_radius_arcsec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">data_release</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">df_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_spec_SDSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Source Tol_89 returned no results.
Source COSMOS1 returned no results.
Source COSMOS2 returned no results.
Source COSMOS3 returned no results.
Source JADESGS-z7-01-QU returned no results.
Source TestJWST returned no results.
Source TestEuclid returned no results.
CPU times: user 136 ms, sys: 21.1 ms, total: 157 ms
Wall time: 4.24 s
</pre></div>
</div>
</div>
</div>
</section>
<section id="desi-archive">
<h3>2.5 DESI Archive<a class="headerlink" href="#desi-archive" title="Link to this heading">#</a></h3>
<p>This includes DESI spectra. Here, we use the <code class="docutils literal notranslate"><span class="pre">SPARCL</span></code> query. Note that this can also be used
for SDSS searches, however, according to the SPARCL webpage, only up to DR16 is included.
Therefore, we will not include SDSS DR16 here (this is treated in the SDSS search above).</p>
<p>The DESI search is currently commented out because <code class="docutils literal notranslate"><span class="pre">SPARCL</span></code> is not compatible with numpy &gt; 2 which we require for the other modules to run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%time</span>
<span class="c1">## Get DESI and BOSS spectra with SPARCL</span>
<span class="c1">#df_spec_DESIBOSS = DESIBOSS_get_spec(sample_table, search_radius_arcsec=5)</span>
<span class="c1">#df_spec.append(df_spec_DESIBOSS)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="make-plots-of-luminosity-as-a-function-of-time">
<h2>3. Make plots of luminosity as a function of time<a class="headerlink" href="#make-plots-of-luminosity-as-a-function-of-time" title="Link to this heading">#</a></h2>
<p>We show flux in mJy as a function of time for all available bands for each object.
<code class="docutils literal notranslate"><span class="pre">show_nbr_figures</span></code> controls how many plots are actually generated and returned to the screen.
If you choose to save the plots with <code class="docutils literal notranslate"><span class="pre">save_output</span></code>, they will be put in the output directory and
labelled by sample number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Plotting ####</span>
<span class="n">create_figures</span><span class="p">(</span><span class="n">df_spec</span><span class="o">=</span><span class="n">df_spec</span><span class="p">,</span>
               <span class="n">bin_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">show_nbr_figures</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
               <span class="n">save_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/916a6259d8087cdff79ee8ce2f71ca8c1997f312eb88db11fe6ba554381ed35e.png" src="../_images/916a6259d8087cdff79ee8ce2f71ca8c1997f312eb88db11fe6ba554381ed35e.png" />
<img alt="../_images/7c5600b3ac87fb101e6f5c4b2aaaf561e93a4c490103e4c3634887357a50200d.png" src="../_images/7c5600b3ac87fb101e6f5c4b2aaaf561e93a4c490103e4c3634887357a50200d.png" />
<img alt="../_images/f9e530eca14e15b4d9c1a5f2d73bc0991a7b59deb15072f42bed9b3a288a2f73.png" src="../_images/f9e530eca14e15b4d9c1a5f2d73bc0991a7b59deb15072f42bed9b3a288a2f73.png" />
<img alt="../_images/850568e4ddf3c2f4858279a23e4d48b5a23878abb1346f913c483afa7fb2b58d.png" src="../_images/850568e4ddf3c2f4858279a23e4d48b5a23878abb1346f913c483afa7fb2b58d.png" />
<img alt="../_images/c54f28fcbba90f943934806041e21549f039a5797aabb8f2360883faa857d646.png" src="../_images/c54f28fcbba90f943934806041e21549f039a5797aabb8f2360883faa857d646.png" />
<img alt="../_images/39393c1dd37000580367788e36e12728caa49ec06e05cf8a5bfb97cb6cb1333a.png" src="../_images/39393c1dd37000580367788e36e12728caa49ec06e05cf8a5bfb97cb6cb1333a.png" />
<img alt="../_images/a74186b62d8a67cbbf9ca4ca9c75b2c33e33d6f357f1641b5807b1ed68a80806.png" src="../_images/a74186b62d8a67cbbf9ca4ca9c75b2c33e33d6f357f1641b5807b1ed68a80806.png" />
<img alt="../_images/2adb6fa8e4a34f8eb3208bca4d2e0bff81f0cdde7e9fe863c7cd12a72c40b4ca.png" src="../_images/2adb6fa8e4a34f8eb3208bca4d2e0bff81f0cdde7e9fe863c7cd12a72c40b4ca.png" />
<img alt="../_images/d7f748b3bae453781dbb67535a69a150839b55209490e95f87313cb72ef9729d.png" src="../_images/d7f748b3bae453781dbb67535a69a150839b55209490e95f87313cb72ef9729d.png" />
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Spectroscopy</p>
      </div>
    </a>
    <a class="right-next"
       href="../crossmatch/README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cross Matching</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-of-spectroscopic-archives-and-status">List of Spectroscopic Archives and Status</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input">Input:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output">Output:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-standard-imports">Non-standard Imports:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime">Runtime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#authors">Authors:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-that-were-considered-but-didn-t-end-up-being-used">Datasets that were considered but didn’t end up being used:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#irtf">IRTF:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-sample">1. Define the sample</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-out-your-sample-to-disk">1.2 Write out your sample to disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-sample-table-from-disk">1.3 Load the sample table from disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-data-structure-to-hold-the-spectra">1.4 Initialize data structure to hold the spectra</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-spectra-for-these-targets-in-nasa-and-other-ancillary-catalogs">2. Find spectra for these targets in NASA and other ancillary catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irsa-archive">2.1 IRSA Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-archive">2.2 MAST Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esa-archive">2.3 ESA Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdss-archive">2.4 SDSS Archive</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#desi-archive">2.5 DESI Archive</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-plots-of-luminosity-as-a-function-of-time">3. Make plots of luminosity as a function of time</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fornax developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025, Fornax developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Make Multi-Wavelength Light Curves Using Archival Data &#8212; Fornax Demo Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'light_curves/light_curve_generator';</script>
    <link rel="icon" href="../_static/fornax_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Make Multi-Wavelength Light Curves for Large Samples" href="scale_up.html" />
    <link rel="prev" title="Time Domain" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/fornax_logo.png" class="logo__image only-light" alt="Fornax Demo Notebooks - Home"/>
    <script>document.write(`<img src="../_static/fornax_logo.png" class="logo__image only-dark" alt="Fornax Demo Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/nasa-fornax/fornax-demo-notebooks" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    The Fornax Initiative
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../forced_photometry/README.html">Multi-band forced photometry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../forced_photometry/multiband_photometry.html">Automated Multiband Forced Photometry on Large Datasets</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Time Domain</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Make Multi-Wavelength Light Curves Using Archival Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="scale_up.html">Make Multi-Wavelength Light Curves for Large Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="light_curve_classifier.html">Light Curve Classifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="ML_AGNzoo.html">AGN Zoo: Comparison of AGN selected with different metrics</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nasa-fornax/fornax-demo-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nasa-fornax/fornax-demo-notebooks/issues/new?title=Issue%20on%20page%20%2Flight_curves/light_curve_generator.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/light_curves/light_curve_generator.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Make Multi-Wavelength Light Curves Using Archival Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input">Input:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output">Output:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime">Runtime:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#authors">Authors:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-sample">1. Define the sample</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-your-own-sample">1.1 Build your own sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-out-your-sample-to-disk">1.2 Write out your sample to disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-sample-table-from-disk">1.3 Load the sample table from disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-data-structure-to-hold-the-light-curves">1.4 Initialize data structure to hold the light curves</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-nasa-catalogs">2. Find light curves for these targets in NASA catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heasarc-fermi-beppo-sax">2.1 HEASARC: FERMI &amp; Beppo SAX</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irsa-wise">2.2 IRSA: WISE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-pan-starrs">2.3 MAST: Pan-STARRS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-tess-kepler-and-k2">2.4 MAST: TESS, Kepler and K2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-hubble-catalog-of-variables-hcv">2.5 MAST: Hubble Catalog of Variables (HCV)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs">3. Find light curves for these targets in relevant, non-NASA catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irsa-ztf">3.1 IRSA: ZTF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaia">3.2 Gaia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#icecube-neutrinos">3.3 IceCube neutrinos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rubin-data">3.4 Rubin Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-processing-the-archive-calls">4. Parallel processing the archive calls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-plots-of-luminosity-as-a-function-of-time">5. Make plots of luminosity as a function of time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="make-multi-wavelength-light-curves-using-archival-data">
<h1>Make Multi-Wavelength Light Curves Using Archival Data<a class="headerlink" href="#make-multi-wavelength-light-curves-using-archival-data" title="Link to this heading">#</a></h1>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<p>By the end of this tutorial, you will be able to:</p>
<ul class="simple">
<li><p>Automatically load a catalog of target sources</p></li>
<li><p>Automatically &amp; efficiently search NASA and non-NASA resources for the light curves of up to ~500 targets</p></li>
<li><p>Store &amp; manipulate light curves in a Pandas MultiIndex dataframe</p></li>
<li><p>Plot all light curves on the same plot</p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction:<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A user has a sample of interesting targets for which they would like to see a plot of available archival light curves.  We start with a small set of changing look AGN from Yang et al., 2018, which are automatically downloaded. Changing look AGN are cases where the broad emission lines appear or disappear (and not just that the flux is variable).</p></li>
<li><p>We model light curve plots after van Velzen et al. 2021.  We search through a curated list of time-domain NASA holdings as well as non-NASA sources.  HEASARC catalogs used are Fermi and Beppo-Sax, IRSA catalogs used are ZTF and WISE, and MAST catalogs used are Pan-STARRS, TESS, Kepler, and K2.  Non-NASA sources are Gaia and IceCube. This list is generalized enough to include many types of targets to make this notebook interesting for many types of science.  All of these time-domain archives are searched in an automated and efficient fashion using astroquery, pyvo, pyarrow or APIs.</p></li>
<li><p>Light curve data storage is a tricky problem.  Currently we are using a MultiIndex Pandas dataframe, as the best existing choice for right now.  One downside is that we need to manually track the units of flux and time instead of relying on an astropy storage scheme which would be able to do some of the units worrying for us (even astropy can’t do all magnitude to flux conversions).  Astropy does not currently have a good option for multi-band light curve storage.</p></li>
<li><p>This notebook walks through the individual steps required to collect the targets and their light curves and create figures. It also shows how to speed up the collection of light curves using python’s <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code>. This is expected to be sufficient for up to ~500 targets. For a larger number of targets, consider using the bash script demonstrated in the neighboring notebook <a class="reference internal" href="scale_up.html"><span class="std std-doc">scale_up</span></a>.</p></li>
<li><p>ML work using these time-series light curves is in two neighboring notebooks: <a class="reference internal" href="ML_AGNzoo.html"><span class="std std-doc">ML_AGNzoo</span></a> and <a class="reference internal" href="light_curve_classifier.html"><span class="std std-doc">light_curve_classifier</span></a>.</p></li>
</ul>
</section>
<section id="input">
<h2>Input:<a class="headerlink" href="#input" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>choose from a list of known changing look AGN from the literature
OR -</p></li>
<li><p>input your own sample</p></li>
</ul>
</section>
<section id="output">
<h2>Output:<a class="headerlink" href="#output" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>an archival optical + IR + neutrino light curve</p></li>
</ul>
</section>
<section id="runtime">
<h2>Runtime:<a class="headerlink" href="#runtime" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>As of 2025 May, this notebook takes ~1000s (17 min.) to run to completion on Fornax using the ‘Astrophysics Default Image’ and the ‘Large’ server with 64GB RAM/ 16CPU.</p></li>
</ul>
</section>
<section id="authors">
<h2>Authors:<a class="headerlink" href="#authors" title="Link to this heading">#</a></h2>
<p>Jessica Krick, Shoubaneh Hemmati, Andreas Faisst, Troy Raen, Brigitta Sipőcz, David Shupe</p>
</section>
<section id="acknowledgements">
<h2>Acknowledgements:<a class="headerlink" href="#acknowledgements" title="Link to this heading">#</a></h2>
<p>Suvi Gezari, Antara Basu-zych, Stephanie LaMassa
MAST, HEASARC, &amp; IRSA Fornax teams</p>
</section>
<section id="imports">
<h2>Imports:<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">acstools</span></code> to work with HST magnitude to flux conversion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astropy</span></code> to work with coordinates/units and data structures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astroquery</span></code> to interface with archives APIs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hpgeom</span></code> to locate coordinates in HEALPix space</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lightkurve</span></code> to search TESS, Kepler, and K2 archives</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> for plotting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> to use the power of multiple CPUs to get work done faster</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> for numerical processing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> with their <code class="docutils literal notranslate"><span class="pre">[aws]</span></code> extras for their data structure DataFrame and all the accompanying functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> to work with Parquet files for WISE and ZTF</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyvo</span></code> for accessing Virtual Observatory(VO) standard data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requests</span></code> to get information from URLs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy</span></code> to do statistics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code> to track progress on long running jobs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">urllib</span></code> to handle archive searches with website interface</p></li>
</ul>
<p>This cell will install them if needed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment the next line to install dependencies if needed.</span>
<span class="c1"># %pip install -r requirements_light_curve_generator.txt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>

<span class="c1"># local code imports</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;code_src/&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">data_structures</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiIndexDFObject</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gaia_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaia_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hcv_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">hcv_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">heasarc_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">heasarc_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">icecube_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">icecube_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">panstarrs_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">panstarrs_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plot_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_figures</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sample_selection</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">clean_sample</span><span class="p">,</span> <span class="n">get_green_sample</span><span class="p">,</span> <span class="n">get_hon_sample</span><span class="p">,</span> <span class="n">get_lamassa_sample</span><span class="p">,</span> <span class="n">get_lopeznavas_sample</span><span class="p">,</span>
    <span class="n">get_lyu_sample</span><span class="p">,</span> <span class="n">get_macleod16_sample</span><span class="p">,</span> <span class="n">get_macleod19_sample</span><span class="p">,</span> <span class="n">get_ruan_sample</span><span class="p">,</span> <span class="n">get_sdss_sample</span><span class="p">,</span> <span class="n">get_sheng_sample</span><span class="p">,</span> <span class="n">get_yang_sample</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tess_kepler_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">tess_kepler_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wise_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">wise_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rubin_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">rubin_get_lightcurves</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ztf_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ztf_get_lightcurves</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-sample">
<h2>1. Define the sample<a class="headerlink" href="#define-the-sample" title="Link to this heading">#</a></h2>
<p>We define here a “gold” sample of spectroscopically confirmed changing look AGN and quasars. This sample includes both objects which change from type 1 to type 2 and also the opposite.  Future studies may want to treat these as separate objects or separate QSOs from AGN.  Bibcodes for the samples used are listed next to their functions for reference.</p>
<p>Significant work went into the functions which grab the samples from the papers.  They use Astroquery, NED, SIMBAD, Vizier, and in a few cases grab the tables from the html versions of the paper.  There are trickeries involved in accessing coordinates from tables in the literature. Not every literature table is stored in its entirety in all of these resources, so be sure to check that your chosen method is actually getting the information that you see in the paper table.  Warning: You will get false results if using NED or SIMBAD on a table that has more rows than are printed in the journal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build up the sample</span>
<span class="c1"># Initially set up lists to hold the coordinates and their reference paper name as a label</span>
<span class="n">coords</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Choose your own adventure:</span>

<span class="c1">#get_lamassa_sample(coords, labels)  #2015ApJ...800..144L</span>
<span class="c1">#get_macleod16_sample(coords, labels) #2016MNRAS.457..389M</span>
<span class="c1">#get_ruan_sample(coords, labels) #2016ApJ...826..188R</span>
<span class="c1">#get_macleod19_sample(coords, labels)  #2019ApJ...874....8M</span>
<span class="c1">#get_sheng_sample(coords, labels)  #2020ApJ...889...46S</span>
<span class="c1">#get_green_sample(coords, labels)  #2022ApJ...933..180G</span>
<span class="c1">#get_lyu_sample(coords, labels)  #z32022ApJ...927..227L</span>
<span class="c1">#get_lopeznavas_sample(coords, labels)  #2022MNRAS.513L..57L</span>
<span class="c1">#get_hon_sample(coords, labels)  #2022MNRAS.511...54H</span>
<span class="n">get_yang_sample</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>   <span class="c1">#2018ApJ...862..109Y</span>

<span class="c1"># Get some &quot;normal&quot; QSOs</span>
<span class="c1"># there are ~500K of these, so choose the number based on</span>
<span class="c1"># a balance between speed of running the light curves and whatever</span>
<span class="c1"># the ML algorithms would like to have</span>

<span class="c1"># num_normal_QSO = 5000</span>
<span class="c1"># zmin, zmax = 0, 10</span>
<span class="c1"># randomize_z = False</span>
<span class="c1">#get_sdss_sample(coords, labels, num=num_normal_QSO, zmin=zmin, zmax=zmax, randomize_z=randomize_z)</span>

<span class="c1"># Remove duplicates, attach an objectid to the coords,</span>
<span class="c1"># convert to astropy table to keep all relevant info together</span>
<span class="n">sample_table</span> <span class="o">=</span> <span class="n">clean_sample</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1">#give this sample a name for use in saving files</span>
<span class="n">sample_name</span> <span class="o">=</span> <span class="s2">&quot;yang_CLAGN&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_table</span>
</pre></div>
</div>
</div>
</div>
<section id="build-your-own-sample">
<h3>1.1 Build your own sample<a class="headerlink" href="#build-your-own-sample" title="Link to this heading">#</a></h3>
<p>To build your own sample, you can follow the examples of functions above to grab coordinates from your favorite literature resource,</p>
<p>or</p>
<p>You can use <a class="reference external" href="https://docs.astropy.org/en/stable/io/ascii/read.html">astropy’s read</a> function to read in an input table
to an <a class="reference external" href="https://docs.astropy.org/en/stable/table/">astropy table</a></p>
</section>
<section id="write-out-your-sample-to-disk">
<h3>1.2 Write out your sample to disk<a class="headerlink" href="#write-out-your-sample-to-disk" title="Link to this heading">#</a></h3>
<p>At this point you may wish to write out your sample to disk and reuse that in future work sessions, instead of creating it from scratch again.</p>
<p>For the format of the save file, we would suggest to choose from various formats that fully support astropy objects(eg., SkyCoord).  One example that works is Enhanced Character-Separated Values or <a class="reference external" href="https://docs.astropy.org/en/stable/io/ascii/ecsv.html">‘ecsv’</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">savename_sample</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;output/</span><span class="si">{</span><span class="n">sample_name</span><span class="si">}</span><span class="s2">_sample.ecsv&quot;</span>
<span class="n">sample_table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">savename_sample</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ecsv&#39;</span><span class="p">,</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-sample-table-from-disk">
<h3>1.3 Load the sample table from disk<a class="headerlink" href="#load-the-sample-table-from-disk" title="Link to this heading">#</a></h3>
<p>Do only this step from this section when you have a previously generated sample table</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#sample_table = Table.read(savename_sample, format=&#39;ascii.ecsv&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize-data-structure-to-hold-the-light-curves">
<h3>1.4 Initialize data structure to hold the light curves<a class="headerlink" href="#initialize-data-structure-to-hold-the-light-curves" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We wrote our own class for a Pandas MultiIndex [DataFrame](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html) for storing the light curves</span>
<span class="c1"># This class helps simplify coding of common uses for the DataFrame.</span>
<span class="n">df_lc</span> <span class="o">=</span> <span class="n">MultiIndexDFObject</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="find-light-curves-for-these-targets-in-nasa-catalogs">
<h2>2. Find light curves for these targets in NASA catalogs<a class="headerlink" href="#find-light-curves-for-these-targets-in-nasa-catalogs" title="Link to this heading">#</a></h2>
<p>We search a curated list of time-domain catalogs from NASA astrophysics archives.  Because each archive is different, and in many cases each catalog is different, each function to access a catalog is necessarily specialized to the location and format of that particular catalog.</p>
<section id="heasarc-fermi-beppo-sax">
<h3>2.1 HEASARC: FERMI &amp; Beppo SAX<a class="headerlink" href="#heasarc-fermi-beppo-sax" title="Link to this heading">#</a></h3>
<p>The function to retrieve HEASARC data accesses the HEASARC archive using a pyvo search with a table upload.  This is the fastest way to access data from HEASARC catalogs at scale.</p>
<p>While these aren’t strictly light curves, we would like to track if there are gamma rays detected in advance of any change in the CLAGN light curves. We store these gamma ray detections as single data points.  Because gamma ray detections typically have very large error radii, our current technique is to keep matches in the catalogs within some manually selected error radius, currently defaulting to 1 degree for Fermi and 3 degrees for Beppo SAX.  These values are chosen based on a histogram of all values for those catalogs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_serial</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  <span class="c1">#keep track of all serial archive calls to compare later with parallel archive call time</span>
<span class="n">heasarcstarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># What is the size of error_radius for the catalogs that we will accept for our cross-matching?</span>
<span class="c1"># in degrees; chosen based on histogram of all values for these catalogs</span>
<span class="n">max_fermi_error_radius</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">max_sax_error_radius</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c1"># catalogs to query and their corresponding max error radii</span>
<span class="n">heasarc_catalogs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;FERMIGTRIG&quot;</span><span class="p">:</span> <span class="n">max_fermi_error_radius</span><span class="p">,</span> <span class="s2">&quot;SAXGRBMGRB&quot;</span><span class="p">:</span> <span class="n">max_sax_error_radius</span><span class="p">}</span>

<span class="c1"># get heasarc light curves in the above curated list of catalogs</span>
<span class="n">df_lc_HEASARC</span> <span class="o">=</span> <span class="n">heasarc_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">catalog_error_radii</span><span class="o">=</span><span class="n">heasarc_catalogs</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_HEASARC</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;heasarc search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">heasarcstarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="irsa-wise">
<h3>2.2 IRSA: WISE<a class="headerlink" href="#irsa-wise" title="Link to this heading">#</a></h3>
<p>We use the unWISE light curves catalog (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2023AJ....165...36M/abstract">Meisner et al., 2023</a>) which ties together all WISE &amp; NEOWISE 2010 - 2020 epochs.  Specifically it combines all observations at a single epoch to achieve deeper mag limits than individual observations alone.</p>
<p>The function to retrieve WISE light curves accesses an IRSA generated version of the catalog in parquet format being stored in the AWS cloud <a class="reference external" href="https://registry.opendata.aws/collab/nasa/">Open Data Repository</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WISEstarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">bandlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W1&#39;</span><span class="p">,</span> <span class="s1">&#39;W2&#39;</span><span class="p">]</span>  <span class="c1">#list of the WISE band names</span>
<span class="n">WISE_radius</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># arcsec</span>
<span class="c1"># get WISE light curves</span>
<span class="n">df_lc_WISE</span> <span class="o">=</span> <span class="n">wise_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">WISE_radius</span><span class="p">,</span> <span class="n">bandlist</span><span class="o">=</span><span class="n">bandlist</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_WISE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WISE search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">WISEstarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-pan-starrs">
<h3>2.3 MAST: Pan-STARRS<a class="headerlink" href="#mast-pan-starrs" title="Link to this heading">#</a></h3>
<p>The function to retrieve lightcurves from Pan-STARRS uses <a class="reference external" href="https://docs.lsdb.io/">LSDB</a> to access versions of the object and light curve catalogs that are stored in the cloud.  This function is efficient at large scale (sample sizes &gt; ~1000).</p>
<p>Some warnings are expected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">panstarrsstarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">panstarrs_search_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># search radius = 1 arcsec</span>
<span class="c1"># get panstarrs light curves</span>
<span class="n">df_lc_panstarrs</span> <span class="o">=</span> <span class="n">panstarrs_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">panstarrs_search_radius</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_panstarrs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Panstarrs search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">panstarrsstarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="c1"># Warnings from the panstarrs query about both NESTED and margins are known issues</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-tess-kepler-and-k2">
<h3>2.4 MAST: TESS, Kepler and K2<a class="headerlink" href="#mast-tess-kepler-and-k2" title="Link to this heading">#</a></h3>
<p>The function to retrieve lightcurves from these three missions currently uses the open source package <a class="reference external" href="https://docs.lightkurve.org/index.html"><code class="docutils literal notranslate"><span class="pre">lightKurve</span></code></a>.  This search is not efficient at scale and we expect it to be replaced in the future.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lightkurvestarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">TESS_search_radius</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#arcseconds</span>
<span class="c1"># get TESS/Kepler/K2 light curves</span>
<span class="n">df_lc_TESS</span> <span class="o">=</span> <span class="n">tess_kepler_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">TESS_search_radius</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_TESS</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TESS/Kepler/K2 search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">lightkurvestarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="c1"># LightKurve will return an &quot;Error&quot; when it doesn&#39;t find a match for a target</span>
<span class="c1"># These are not real errors and can be safely ignored.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-hubble-catalog-of-variables-hcv">
<h3>2.5 MAST: Hubble Catalog of Variables (<a class="reference external" href="https://archive.stsci.edu/hlsp/hcv">HCV</a>)<a class="headerlink" href="#mast-hubble-catalog-of-variables-hcv" title="Link to this heading">#</a></h3>
<p>The function to retrieve lightcurves from HCV currently uses their API; based on this <a class="reference external" href="https://archive.stsci.edu/hst/hsc/help/HCV/HCV_API_demo.html">example</a>. This search is not efficient at scale and we expect it to be replaced in the future.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HCVstarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">HCV_radius</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3600.0</span> <span class="c1"># radius = 1 arcsec</span>
<span class="c1"># get HCV light curves</span>
<span class="n">df_lc_HCV</span> <span class="o">=</span> <span class="n">hcv_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">HCV_radius</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_HCV</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;HCV search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">HCVstarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs">
<h2>3. Find light curves for these targets in relevant, non-NASA catalogs<a class="headerlink" href="#find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs" title="Link to this heading">#</a></h2>
<section id="irsa-ztf">
<h3>3.1 IRSA: ZTF<a class="headerlink" href="#irsa-ztf" title="Link to this heading">#</a></h3>
<p>The function to retrieve ZTF light curves accesses a <a class="reference external" href="https://hats.readthedocs.io/en/stable/">HATS</a> parquet version of the ZTF catalog stored in the cloud using <a class="reference external" href="https://docs.lsdb.io/en/stable/">LSDB</a>. This is the simplest way to access this dataset at scale.  The ZTF <a class="reference external" href="https://irsa.ipac.caltech.edu/docs/program_interface/ztf_lightcurve_api.html">API</a> is available for small sample searches.  One unique thing about this function is that it has parallelization built in to the function itself because lsdb uses dask under the hood.</p>
<p>Expect to see many <code class="docutils literal notranslate"><span class="pre">INFO</span></code> messages from dask. These are normal.
The traceback for <code class="docutils literal notranslate"><span class="pre">CommClosedErrors</span></code> is also expected and is just a dask housekeeping issue, the function is still running to completion and returning light curves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ZTFstarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get ZTF lightcurves</span>
<span class="n">ztf_search_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#  arcsec  (Graham et al., 2024 use 1&quot; with good results)</span>
<span class="n">df_lc_ZTF</span> <span class="o">=</span> <span class="n">ztf_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">ztf_search_radius</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_ZTF</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ZTF search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">ZTFstarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="gaia">
<h3>3.2 Gaia<a class="headerlink" href="#gaia" title="Link to this heading">#</a></h3>
<p>The function to retrieve Gaia light curves accesses the Gaia DR3 “source lite” catalog using an astroquery search with a table upload to do the join with the Gaia photometry. This is currently the fastest way to access light curves from Gaia at scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gaiastarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get Gaia light curves</span>
<span class="n">df_lc_gaia</span> <span class="o">=</span> <span class="n">gaia_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">search_radius</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_gaia</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gaia search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">gaiastarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="icecube-neutrinos">
<h3>3.3 IceCube neutrinos<a class="headerlink" href="#icecube-neutrinos" title="Link to this heading">#</a></h3>
<p>There are several <a class="reference external" href="https://icecube.wisc.edu/data-releases/2021/01/all-sky-point-source-icecube-data-years-2008-2018">catalogs</a> (basically one for each year of IceCube data from 2008 - 2018). The following code creates a large catalog by combining
all the yearly catalogs.
The IceCube catalog contains Neutrino detections with associated energy and time and approximate direction (which is uncertain by half-degree scales….). Usually, for active events only one or two Neutrinos are detected, which makes matching quite different compared to “photons”. For our purpose, we will list the top 3 events in energy that are within a given distance to the target.</p>
<p>This time series (time vs. neutrino energy) information is similar to photometry. We choose to storing time and energy in our data structure, leaving error = 0. What is <strong>not</strong> stored in this format is the distance or angular uncertainty of the event direction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">icecubestarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get icecube data points</span>
<span class="n">df_lc_icecube</span> <span class="o">=</span> <span class="n">icecube_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">icecube_select_topN</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_icecube</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;icecube search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">icecubestarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rubin-data">
<h3>3.4 Rubin Data<a class="headerlink" href="#rubin-data" title="Link to this heading">#</a></h3>
<p>Before running this section, you need to have both 1) a login to the Rubin Science Platform (RSP) and 2) an authenticating token setup in your Fornax home directory.</p>
<ol class="arabic simple">
<li><p>To see if you have Rubin data rights, and if you do, to get that login setup, follow these <a class="reference external" href="https://rsp.lsst.io/guides/getting-started/get-an-account.html">instructions</a></p></li>
<li><p>After logging in to RSP, follow these <a class="reference download internal" download="" href="../_downloads/ff9d626b670c445f25e8707d7a5803f3/rsp_token_instructions.txt"><span class="xref download myst">instructions</span></a> to get a token and store it in your home directory.</p></li>
</ol>
<p>This code will not work without the above information, so we have commented it out for now.  Uncomment when you are ready to proceed.</p>
<p>Once that setup is complete, this code access Rubin data from the Rubin Science Platform which is hosting their catalogs in Google Cloud.  Specifically, the code uses <code class="docutils literal notranslate"><span class="pre">pyvo</span></code> and <code class="docutils literal notranslate"><span class="pre">adql</span></code> to access a TAP server.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#uncomment the next 5 lines if you have RSP login and authentication setup</span>

<span class="c1">#rspstarttime = time.time()</span>
<span class="c1">#rsp_search_radius = 0.001  # degrees</span>

<span class="c1">#df_lc_rsp = rubin_get_lightcurves(sample_table, rsp_search_radius)</span>
<span class="c1">#df_lc.append(df_lc_rsp) # add the resulting dataframe to all other archives</span>

<span class="c1">#print(&#39;RSP search took:&#39;, time.time() - rspstarttime, &#39;s&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># benchmarking</span>
<span class="n">end_serial</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total time for serial archive calls is &#39;</span><span class="p">,</span> <span class="n">end_serial</span> <span class="o">-</span> <span class="n">start_serial</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="parallel-processing-the-archive-calls">
<h2>4. Parallel processing the archive calls<a class="headerlink" href="#parallel-processing-the-archive-calls" title="Link to this heading">#</a></h2>
<p>This section shows how to increase the speed of the multi-archive search by running the calls in parallel using python’s <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> library.
This can be a convenient and efficient method for small to medium sample sizes.
One drawback is that error messages tend to get lost in the background and never displayed for the user.
Running this on very large samples may fail because of the way the platform is setup to cull sessions which appear to be inactive.
For sample sizes &gt;~500 and/or improved logging and monitoring options, consider using the bash script demonstrated in the related tutorial notebook <a class="reference internal" href="scale_up.html"><span class="std std-doc">scale_up</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of workers to use in the parallel processing pool</span>
<span class="c1"># this should equal the total number of archives called</span>
<span class="n">n_workers</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># keyword arguments for the archive calls</span>
<span class="n">heasarc_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">catalog_error_radii</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;FERMIGTRIG&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="s2">&quot;SAXGRBMGRB&quot;</span><span class="p">:</span> <span class="s2">&quot;3.0&quot;</span><span class="p">})</span>
<span class="n">ztf_search_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#  arcsec</span>
<span class="n">wise_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">bandlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;W1&#39;</span><span class="p">,</span> <span class="s1">&#39;W2&#39;</span><span class="p">])</span>
<span class="n">panstarrs_search_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># arcsec</span>
<span class="n">tess_kepler_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">hcv_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3600.0</span><span class="p">)</span>
<span class="n">gaia_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">search_radius</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">icecube_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">icecube_select_topN</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rsp_search_radius</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">rsp_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">search_radius</span><span class="o">=</span><span class="n">rsp_search_radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parallel_starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># start a multiprocessing pool and run all the archive queries</span>
<span class="n">parallel_df_lc</span> <span class="o">=</span> <span class="n">MultiIndexDFObject</span><span class="p">()</span>  <span class="c1"># to collect the results</span>
<span class="n">callback</span> <span class="o">=</span> <span class="n">parallel_df_lc</span><span class="o">.</span><span class="n">append</span>  <span class="c1"># will be called once on the result returned by each archive</span>
<span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">n_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>

    <span class="c1"># start the processes that call the archives</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">heasarc_get_lightcurves</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">heasarc_kwargs</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">wise_get_lightcurves</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">wise_kwargs</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">tess_kepler_get_lightcurves</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">tess_kepler_kwargs</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">hcv_get_lightcurves</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">hcv_kwargs</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">gaia_get_lightcurves</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">gaia_kwargs</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">icecube_get_lightcurves</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">icecube_kwargs</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
<span class="c1">#    pool.apply_async(rubin_get_lightcurves, args=(sample_table,), kwds=rsp_kwargs, callback=callback)</span>

    <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># signal that no more jobs will be submitted to the pool</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>  <span class="c1"># wait for all jobs to complete, including the callback</span>

<span class="c1"># run ZTF and panstarrs queries outside of multiprocessing since they</span>
<span class="c1"># are using dask distributed under the hood,</span>
<span class="c1"># which doesn&#39;t work with multiprocessing, and dask is already parallelized</span>

<span class="n">df_lc_ZTF</span> <span class="o">=</span> <span class="n">ztf_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">ztf_search_radius</span><span class="p">)</span>
<span class="n">parallel_df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_ZTF</span><span class="p">)</span><span class="c1"># add the resulting dataframe to all other archives</span>

<span class="n">df_lc_panstarrs</span> <span class="o">=</span> <span class="n">panstarrs_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">panstarrs_search_radius</span><span class="p">)</span>
<span class="n">parallel_df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_panstarrs</span><span class="p">)</span> <span class="c1"># add the panstarrs dataframe to all other archives</span>

<span class="n">parallel_endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># LightKurve will return an &quot;Error&quot; when it doesn&#39;t find a match for a target</span>
<span class="c1"># These are not real errors and can be safely ignored.</span>

<span class="c1"># Warnings from the panstarrs query about both NESTED and margins are known issues</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># How long did parallel processing take?</span>
<span class="c1"># and look at the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel processing took&#39;</span><span class="p">,</span> <span class="n">parallel_endtime</span> <span class="o">-</span> <span class="n">parallel_starttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">parallel_df_lc</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the data for future use with ML notebook</span>
<span class="c1">#parquet_filename = f&quot;output/{sample_name}_df_lc.parquet&quot;</span>
<span class="c1">#parallel_df_lc.data.to_parquet(parquet_savename)</span>
<span class="c1">#print(&quot;file saved!&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Could load a previously saved file in order to plot</span>
<span class="c1">#parallel_df_lc = MultiIndexDFObject()</span>
<span class="c1">#parallel_df_lc.data = pd.read_parquet(parquet_filename)</span>
<span class="c1">#print(&quot;file loaded!&quot;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-plots-of-luminosity-as-a-function-of-time">
<h2>5. Make plots of luminosity as a function of time<a class="headerlink" href="#make-plots-of-luminosity-as-a-function-of-time" title="Link to this heading">#</a></h2>
<p>These plots are modelled after <a class="reference external" href="https://arxiv.org/pdf/2111.09391.pdf">van Velzen et al., 2021</a>. We show flux in mJy as a function of time for all available bands for each object. <code class="docutils literal notranslate"><span class="pre">show_nbr_figures</span></code> controls how many plots are actually generated and returned to the screen.  If you choose to save the plots with <code class="docutils literal notranslate"><span class="pre">save_output</span></code>, they will be put in the output directory and labelled by sample number.</p>
<p><strong>Note</strong> that in the following, we can either plot the results from <code class="docutils literal notranslate"><span class="pre">df_lc</span></code> (from the serial call) or <code class="docutils literal notranslate"><span class="pre">parallel_df_lc</span></code> (from the parallel call). By default (see next cell) the output of the parallel call is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">create_figures</span><span class="p">(</span><span class="n">df_lc</span> <span class="o">=</span> <span class="n">parallel_df_lc</span><span class="p">,</span> <span class="c1"># either df_lc (serial call) or parallel_df_lc (parallel call)</span>
                   <span class="n">show_nbr_figures</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># how many plots do you actually want to see?</span>
                   <span class="n">save_output</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">,</span>  <span class="c1"># should the resulting plots be saved?</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p>This work made use of:</p>
<ul class="simple">
<li><p>Astroquery; Ginsburg et al., 2019, 2019AJ….157…98G</p></li>
<li><p>Astropy; Astropy Collaboration 2022, Astropy Collaboration 2018, Astropy Collaboration 2013,    2022ApJ…935..167A, 2018AJ….156..123A, 2013A&amp;A…558A..33A</p></li>
<li><p>Lightkurve; Lightkurve Collaboration 2018, 2018ascl.soft12013L</p></li>
<li><p>acstools; https://zenodo.org/record/7406933#.ZBH1HS-B0eY</p></li>
<li><p>unWISE light curves; Meisner et al., 2023, 2023AJ….165…36M</p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Time Domain</p>
      </div>
    </a>
    <a class="right-next"
       href="scale_up.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Make Multi-Wavelength Light Curves for Large Samples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input">Input:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output">Output:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime">Runtime:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#authors">Authors:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-sample">1. Define the sample</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-your-own-sample">1.1 Build your own sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-out-your-sample-to-disk">1.2 Write out your sample to disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-sample-table-from-disk">1.3 Load the sample table from disk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-data-structure-to-hold-the-light-curves">1.4 Initialize data structure to hold the light curves</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-nasa-catalogs">2. Find light curves for these targets in NASA catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heasarc-fermi-beppo-sax">2.1 HEASARC: FERMI &amp; Beppo SAX</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irsa-wise">2.2 IRSA: WISE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-pan-starrs">2.3 MAST: Pan-STARRS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-tess-kepler-and-k2">2.4 MAST: TESS, Kepler and K2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-hubble-catalog-of-variables-hcv">2.5 MAST: Hubble Catalog of Variables (HCV)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs">3. Find light curves for these targets in relevant, non-NASA catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irsa-ztf">3.1 IRSA: ZTF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaia">3.2 Gaia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#icecube-neutrinos">3.3 IceCube neutrinos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rubin-data">3.4 Rubin Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-processing-the-archive-calls">4. Parallel processing the archive calls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-plots-of-luminosity-as-a-function-of-time">5. Make plots of luminosity as a function of time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fornax developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025, Fornax developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>